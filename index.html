<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Learn Albanian offline - complete language learning app">
    <meta name="theme-color" content="#dc2626">
    <title>MÃ«so Shqip - Learn Albanian Offline</title>
    <link rel="manifest" href="#" id="manifestPlaceholder">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #dc2626;
            --primary-dark: #b91c1c;
            --secondary: #1e293b;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --success: #16a34a;
            --warning: #f59e0b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding-bottom: 80px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 1.5rem 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .offline-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 1rem;
        }

        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .nav-tab {
            padding: 0.75rem 1.5rem;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            font-weight: 500;
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
        }

        .card h3 {
            margin-bottom: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .translator {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        textarea, input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        textarea:focus, input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 0.875rem 1.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            width: 100%;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-secondary:hover {
            background: #0f172a;
        }

        .phrase-category {
            margin-bottom: 1.5rem;
        }

        .phrase-category h4 {
            color: var(--primary);
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }

        .phrase-item {
            padding: 1rem;
            background: var(--bg);
            border-radius: 12px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .phrase-item:hover {
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .albanian {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text);
            margin-bottom: 0.25rem;
        }

        .english {
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .pronunciation {
            color: var(--warning);
            font-size: 0.85rem;
            font-style: italic;
        }

        .flashcard {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-radius: 16px;
            padding: 3rem 2rem;
            text-align: center;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s;
            position: relative;
            margin-bottom: 1rem;
        }

        .flashcard:active {
            transform: scale(0.98);
        }

        .flashcard-text {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .flashcard-hint {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .flashcard-controls {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .flashcard-controls button {
            flex: 1;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .stat-card {
            background: var(--bg);
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin: 0.5rem 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s;
        }

        .search-box {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-box input {
            padding-right: 3rem;
        }

        .search-results {
            max-height: 400px;
            overflow-y: auto;
        }

        .dict-entry {
            padding: 1rem;
            background: var(--bg);
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        .dict-word {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }

        .dict-type {
            font-size: 0.85rem;
            color: var(--text-light);
            font-style: italic;
        }

        .dict-translation {
            margin-top: 0.25rem;
            color: var(--text);
        }

        .emoji {
            font-size: 1.5rem;
        }

        .tips-list {
            list-style: none;
        }

        .tips-list li {
            padding: 0.75rem;
            background: var(--bg);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            padding-left: 2.5rem;
            position: relative;
        }

        .tips-list li:before {
            content: "ğŸ’¡";
            position: absolute;
            left: 0.75rem;
        }

        .daily-challenge {
            background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 16px;
            margin-bottom: 1rem;
        }

        .daily-challenge h3 {
            color: white;
            margin-bottom: 1rem;
        }

        .install-prompt {
            background: var(--warning);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            display: none;
        }

        .install-prompt.show {
            display: block;
        }

        .word-count {
            text-align: right;
            color: var(--text-light);
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        .switch-lang {
            display: flex;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .switch-lang button {
            padding: 0.5rem 1rem;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .switch-lang button:hover {
            border-color: var(--primary);
        }

        .letter-card {
            background: linear-gradient(135deg, var(--primary) 0%, #b91c1c 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .letter-card:hover {
            transform: scale(1.05);
        }

        .letter {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .letter-sound {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .culture-section {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--border);
        }

        .culture-section:last-child {
            border-bottom: none;
        }

        .culture-section h4 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        #quizOptions {
            display: grid;
            gap: 1rem;
        }

        .quiz-option {
            padding: 1.5rem;
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.1rem;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            background: var(--bg-light);
        }

        .quiz-option.correct {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .quiz-option.incorrect {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .quiz-option.disabled {
            pointer-events: none;
            opacity: 0.6;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                overflow-x: auto;
                white-space: nowrap;
            }

            .letter-card {
                padding: 1rem;
            }

            .letter {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ‡¦ğŸ‡± MÃ«so Shqip</h1>
        <p>Your Albanian language companion</p>
        <div class="offline-badge">âœ“ Works Offline</div>
    </div>

    <div class="install-prompt" id="installPrompt">
        <strong>Install this app!</strong> Add to your home screen for the best offline experience.
        <button class="btn" onclick="installApp()" style="margin-top: 0.5rem; background: white; color: var(--warning);">Install Now</button>
    </div>

    <div class="container">
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="switchTab('daily')">ğŸ“… Daily</div>
            <div class="nav-tab" onclick="switchTab('quickstart')">âš¡ Quick</div>
            <div class="nav-tab" onclick="switchTab('voice')">ğŸ¤ Voice</div>
            <div class="nav-tab" onclick="switchTab('translator')">ğŸ”„ Translator</div>
            <div class="nav-tab" onclick="switchTab('dictionary')">ğŸ“– Dictionary</div>
            <div class="nav-tab" onclick="switchTab('phrases')">ğŸ’¬ Phrases</div>
            <div class="nav-tab" onclick="switchTab('builder')">ğŸ—ï¸ Builder</div>
            <div class="nav-tab" onclick="switchTab('alphabet')">ğŸ”¤ Alphabet</div>
            <div class="nav-tab" onclick="switchTab('quiz')">ğŸ¯ Quiz</div>
            <div class="nav-tab" onclick="switchTab('culture')">ğŸ‡¦ğŸ‡± Culture</div>
            <div class="nav-tab" onclick="switchTab('flashcards')">ğŸ´ Cards</div>
            <div class="nav-tab" onclick="switchTab('progress')">ğŸ“Š Progress</div>
        </div>

        <div id="daily" class="tab-content active">
            <div class="daily-challenge">
                <h3>Today's Challenge</h3>
                <p id="dailyGoal">Learn 5 new phrases and practice for 15 minutes!</p>
                <div class="progress-bar" style="background: rgba(255,255,255,0.3); margin-top: 1rem;">
                    <div class="progress-fill" id="dailyProgress" style="width: 0%; background: white;"></div>
                </div>
            </div>

            <div class="card">
                <h3><span class="emoji">ğŸŒŸ</span> Phrase of the Day</h3>
                <div class="phrase-item" style="border: 2px solid var(--primary);">
                    <div class="albanian" id="dailyPhraseAlb">MirÃ«dita! Si jeni?</div>
                    <div class="pronunciation" id="dailyPhrasePron">meer-DEE-tah! see YEH-nee?</div>
                    <div class="english" id="dailyPhraseEng">Good day! How are you?</div>
                </div>
            </div>

            <div class="card">
                <h3><span class="emoji">â­</span> Your Favorites</h3>
                <div id="favoritesList">
                    <p style="text-align: center; color: var(--text-light); padding: 1rem;">No favorites yet. Click the â­ on phrases to save them here!</p>
                </div>
            </div>

            <div class="card">
                <h3><span class="emoji">ğŸ•</span> Recently Used</h3>
                <div id="historyList">
                    <p style="text-align: center; color: var(--text-light); padding: 1rem;">Your recent translations will appear here.</p>
                </div>
            </div>

            <div class="card">
                <h3><span class="emoji">ğŸ¯</span> Quick Start Guide</h3>
                <ul class="tips-list">
                    <li>Albanian uses 36 letters - similar to English but with some extras</li>
                    <li>Pronunciation is mostly phonetic - read as written!</li>
                    <li>Start with greetings and basic courtesy phrases</li>
                    <li>This app works 100% offline - perfect for travel!</li>
                    <li>Dictionary has 650+ common words built-in</li>
                    <li>Click â­ to save your favorite phrases for quick access!</li>
                </ul>
            </div>
        </div>

        <div id="quickstart" class="tab-content">
            <div class="card" style="background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white;">
                <h3 style="color: white;"><span class="emoji">ğŸš¨</span> Emergency Phrases</h3>
                <div class="phrase-item" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.5);" onclick="copyToClipboard('MÃ« ndihmoni ju lutem')">
                    <div class="albanian" style="color: white;">MÃ« ndihmoni ju lutem</div>
                    <div class="pronunciation" style="color: rgba(255,255,255,0.9);">muh ndee-MOH-nee yoo LOO-tem</div>
                    <div class="english" style="color: rgba(255,255,255,0.8);">Please help me ğŸ“‹</div>
                </div>
                <div class="phrase-item" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.5);" onclick="copyToClipboard('Thirrni policinÃ«')">
                    <div class="albanian" style="color: white;">Thirrni policinÃ«</div>
                    <div class="pronunciation" style="color: rgba(255,255,255,0.9);">THEER-nee po-lee-TSEE-nuh</div>
                    <div class="english" style="color: rgba(255,255,255,0.8);">Call the police ğŸ“‹</div>
                </div>
                <div class="phrase-item" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.5);" onclick="copyToClipboard('Kam nevojÃ« pÃ«r doktor')">
                    <div class="albanian" style="color: white;">Kam nevojÃ« pÃ«r doktor</div>
                    <div class="pronunciation" style="color: rgba(255,255,255,0.9);">kahm neh-VOY-uh puhr DOK-tor</div>
                    <div class="english" style="color: rgba(255,255,255,0.8);">I need a doctor ğŸ“‹</div>
                </div>
                <div class="phrase-item" style="background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.5);" onclick="copyToClipboard('Ku Ã«shtÃ« spitali?')">
                    <div class="albanian" style="color: white;">Ku Ã«shtÃ« spitali?</div>
                    <div class="pronunciation" style="color: rgba(255,255,255,0.9);">koo UH-shtuh spee-TAHL</div>
                    <div class="english" style="color: rgba(255,255,255,0.8);">Where is the hospital? ğŸ“‹</div>
                </div>
            </div>

            <div class="card">
                <h3><span class="emoji">ğŸ½ï¸</span> Restaurant Essentials</h3>
                <button class="btn" onclick="speakPhrase('MenunÃ« ju lutem')" style="margin-bottom: 0.5rem;">ğŸ”Š MenunÃ« ju lutem <small>(Menu please)</small></button>
                <button class="btn" onclick="speakPhrase('FaturÃ«n ju lutem')" style="margin-bottom: 0.5rem;">ğŸ”Š FaturÃ«n ju lutem <small>(Bill please)</small></button>
                <button class="btn" onclick="speakPhrase('NjÃ« ujÃ« ju lutem')" style="margin-bottom: 0.5rem;">ğŸ”Š NjÃ« ujÃ« ju lutem <small>(Water please)</small></button>
                <button class="btn" onclick="speakPhrase('Ishte shumÃ« e mirÃ«')" style="margin-bottom: 0.5rem;">ğŸ”Š Ishte shumÃ« e mirÃ« <small>(It was very good)</small></button>
            </div>

            <div class="card">
                <h3><span class="emoji">ğŸš•</span> Taxi & Transport</h3>
                <button class="btn btn-secondary" onclick="speakPhrase('Sa kushton?')" style="margin-bottom: 0.5rem;">ğŸ”Š Sa kushton? <small>(How much?)</small></button>
                <button class="btn btn-secondary" onclick="speakPhrase('Ndaloni kÃ«tu ju lutem')" style="margin-bottom: 0.5rem;">ğŸ”Š Ndaloni kÃ«tu ju lutem <small>(Stop here please)</small></button>
                <button class="btn btn-secondary" onclick="speakPhrase('MÃ« Ã§oni kÃ«tu')" style="margin-bottom: 0.5rem;">ğŸ”Š MÃ« Ã§oni kÃ«tu <small>(Take me here)</small></button>
            </div>

            <div class="card">
                <h3><span class="emoji">ğŸ›ï¸</span> Shopping Quick Phrases</h3>
                <button class="btn" onclick="speakPhrase('Sa Ã«shtÃ«?')" style="margin-bottom: 0.5rem; background: var(--success);">ğŸ”Š Sa Ã«shtÃ«? <small>(How much is it?)</small></button>
                <button class="btn" onclick="speakPhrase('ShumÃ« shtrenjtÃ«')" style="margin-bottom: 0.5rem; background: var(--success);">ğŸ”Š ShumÃ« shtrenjtÃ« <small>(Too expensive)</small></button>
                <button class="btn" onclick="speakPhrase('Do ta blej')" style="margin-bottom: 0.5rem; background: var(--success);">ğŸ”Š Do ta blej <small>(I'll take it)</small></button>
            </div>
        </div>

        <div id="voice" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ¤</span> Voice Translator</h3>
                <p style="margin-bottom: 1rem; color: var(--text-light);">Speak English and get instant Albanian translation!</p>
                
                <div style="text-align: center; margin: 2rem 0;">
                    <button id="voiceBtn" onclick="startVoiceRecognition()" class="btn" style="font-size: 1.2rem; padding: 1.5rem 2rem; background: var(--primary);">
                        ğŸ¤ Tap to Speak
                    </button>
                    <p id="voiceStatus" style="margin-top: 1rem; color: var(--text-light); font-style: italic;">Ready to listen...</p>
                </div>

                <div id="voiceResult" style="display: none; padding: 1.5rem; background: var(--success); color: white; border-radius: 12px; margin-top: 1rem;">
                    <div style="margin-bottom: 1rem;">
                        <strong>You said:</strong>
                        <div id="voiceInput" style="font-size: 1.1rem; margin-top: 0.5rem;"></div>
                    </div>
                    <div>
                        <strong>Albanian:</strong>
                        <div id="voiceOutput" style="font-size: 1.5rem; font-weight: 600; margin-top: 0.5rem;"></div>
                    </div>
                    <button onclick="speakVoiceResult()" class="btn" style="background: white; color: var(--success); margin-top: 1rem;">ğŸ”Š Speak It</button>
                </div>

                <div class="card" style="background: var(--bg-light); margin-top: 1rem;">
                    <p style="font-size: 0.9rem; color: var(--text-light);">
                        ğŸ’¡ <strong>Tips:</strong><br>
                        â€¢ Speak clearly in English<br>
                        â€¢ Works best with simple phrases<br>
                        â€¢ Requires internet for speech recognition<br>
                        â€¢ Translation happens offline using the dictionary
                    </p>
                </div>
            </div>
        </div>

        <div id="alphabet" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ”¤</span> Albanian Alphabet</h3>
                <p style="margin-bottom: 1rem; color: var(--text-light);">36 letters - master the sounds!</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 1rem;">
                    <div class="letter-card" onclick="pronounceLetter('a', 'ah')">
                        <div class="letter">A a</div>
                        <div class="letter-sound">ah</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('b', 'beh')">
                        <div class="letter">B b</div>
                        <div class="letter-sound">beh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('c', 'tseh')">
                        <div class="letter">C c</div>
                        <div class="letter-sound">tseh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('Ã§', 'cheh')">
                        <div class="letter">Ã‡ Ã§</div>
                        <div class="letter-sound">cheh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('d', 'deh')">
                        <div class="letter">D d</div>
                        <div class="letter-sound">deh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('dh', 'th (as in this)')">
                        <div class="letter">Dh dh</div>
                        <div class="letter-sound">th (this)</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('e', 'eh')">
                        <div class="letter">E e</div>
                        <div class="letter-sound">eh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('Ã«', 'uh')">
                        <div class="letter">Ã‹ Ã«</div>
                        <div class="letter-sound">uh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('f', 'feh')">
                        <div class="letter">F f</div>
                        <div class="letter-sound">feh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('g', 'geh')">
                        <div class="letter">G g</div>
                        <div class="letter-sound">geh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('gj', 'gyeh')">
                        <div class="letter">Gj gj</div>
                        <div class="letter-sound">gyeh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('h', 'hah')">
                        <div class="letter">H h</div>
                        <div class="letter-sound">hah</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('i', 'ee')">
                        <div class="letter">I i</div>
                        <div class="letter-sound">ee</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('j', 'yeh')">
                        <div class="letter">J j</div>
                        <div class="letter-sound">yeh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('k', 'kah')">
                        <div class="letter">K k</div>
                        <div class="letter-sound">kah</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('l', 'leh')">
                        <div class="letter">L l</div>
                        <div class="letter-sound">leh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('ll', 'lyeh')">
                        <div class="letter">Ll ll</div>
                        <div class="letter-sound">lyeh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('m', 'meh')">
                        <div class="letter">M m</div>
                        <div class="letter-sound">meh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('n', 'neh')">
                        <div class="letter">N n</div>
                        <div class="letter-sound">neh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('nj', 'nyeh')">
                        <div class="letter">Nj nj</div>
                        <div class="letter-sound">nyeh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('o', 'oh')">
                        <div class="letter">O o</div>
                        <div class="letter-sound">oh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('p', 'peh')">
                        <div class="letter">P p</div>
                        <div class="letter-sound">peh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('q', 'cheh')">
                        <div class="letter">Q q</div>
                        <div class="letter-sound">cheh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('r', 'reh')">
                        <div class="letter">R r</div>
                        <div class="letter-sound">reh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('rr', 'rreh (rolled)')">
                        <div class="letter">Rr rr</div>
                        <div class="letter-sound">rreh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('s', 'seh')">
                        <div class="letter">S s</div>
                        <div class="letter-sound">seh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('sh', 'sheh')">
                        <div class="letter">Sh sh</div>
                        <div class="letter-sound">sheh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('t', 'teh')">
                        <div class="letter">T t</div>
                        <div class="letter-sound">teh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('th', 'th (as in think)')">
                        <div class="letter">Th th</div>
                        <div class="letter-sound">th (think)</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('u', 'oo')">
                        <div class="letter">U u</div>
                        <div class="letter-sound">oo</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('v', 'veh')">
                        <div class="letter">V v</div>
                        <div class="letter-sound">veh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('x', 'dz')">
                        <div class="letter">X x</div>
                        <div class="letter-sound">dz</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('xh', 'j (as in judge)')">
                        <div class="letter">Xh xh</div>
                        <div class="letter-sound">j (judge)</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('y', 'oo (short)')">
                        <div class="letter">Y y</div>
                        <div class="letter-sound">Ã¼</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('z', 'zeh')">
                        <div class="letter">Z z</div>
                        <div class="letter-sound">zeh</div>
                    </div>
                    <div class="letter-card" onclick="pronounceLetter('zh', 'zh (as in measure)')">
                        <div class="letter">Zh zh</div>
                        <div class="letter-sound">zh</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3><span class="emoji">ğŸ’¡</span> Key Pronunciation Tips</h3>
                <ul class="tips-list">
                    <li><strong>Ã‹ (Ã«)</strong> - Like the 'u' in "but" - the schwa sound</li>
                    <li><strong>Ã‡ (Ã§)</strong> - Like "ch" in "cheese"</li>
                    <li><strong>Q (q)</strong> - Similar to "ch" but slightly different</li>
                    <li><strong>Rr (rr)</strong> - Rolled R, like Spanish "perro"</li>
                    <li><strong>Xh (xh)</strong> - Like the "j" in "judge"</li>
                    <li><strong>Digraphs</strong> - dh, th, sh, zh, gj, nj, etc. are single sounds!</li>
                    <li><strong>Stress</strong> - Usually on the last syllable before the ending</li>
                </ul>
            </div>
        </div>

        <div id="quiz" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ¯</span> Quiz Mode</h3>
                <p style="margin-bottom: 1rem; color: var(--text-light);">Test your Albanian knowledge!</p>
                
                <div id="quizStart">
                    <button class="btn" onclick="startQuiz('words')" style="width: 100%; margin-bottom: 1rem; padding: 1.5rem;">
                        ğŸ“– Word Quiz (10 questions)
                    </button>
                    <button class="btn btn-secondary" onclick="startQuiz('phrases')" style="width: 100%; margin-bottom: 1rem; padding: 1.5rem;">
                        ğŸ’¬ Phrase Quiz (10 questions)
                    </button>
                    <button class="btn" onclick="startQuiz('listening')" style="width: 100%; padding: 1.5rem; background: var(--success);">
                        ğŸ”Š Listening Quiz (5 questions)
                    </button>
                </div>

                <div id="quizContainer" style="display: none;">
                    <div style="text-align: right; color: var(--text-light); margin-bottom: 1rem;">
                        Question <span id="quizCurrent">1</span> / <span id="quizTotal">10</span>
                    </div>
                    
                    <div id="quizQuestion" style="font-size: 1.5rem; font-weight: 600; margin-bottom: 2rem; text-align: center;"></div>
                    
                    <div id="quizOptions" style="display: grid; gap: 1rem;"></div>
                    
                    <div id="quizFeedback" style="display: none; margin-top: 2rem; padding: 1.5rem; border-radius: 12px; text-align: center; font-weight: 600;"></div>
                    
                    <button id="quizNext" onclick="nextQuestion()" style="display: none; margin-top: 1rem; width: 100%;" class="btn">Next Question â†’</button>
                </div>

                <div id="quizResults" style="display: none;">
                    <div style="text-align: center; padding: 2rem;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;" id="quizEmoji">ğŸ‰</div>
                        <h3 id="quizScore" style="font-size: 2rem; margin-bottom: 1rem;"></h3>
                        <p id="quizMessage" style="color: var(--text-light); margin-bottom: 2rem;"></p>
                        <button class="btn" onclick="resetQuiz()" style="padding: 1rem 2rem;">Try Again</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="culture" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ‡¦ğŸ‡±</span> Cultural Tips & Etiquette</h3>
                
                <div class="culture-section">
                    <h4>ğŸ¤ Greetings</h4>
                    <ul class="tips-list">
                        <li>Handshakes are common for both men and women</li>
                        <li>Close friends may kiss on both cheeks</li>
                        <li>Always greet the eldest person first</li>
                        <li>"MirÃ«dita" (Good day) works anytime during daylight</li>
                    </ul>
                </div>

                <div class="culture-section">
                    <h4>ğŸ½ï¸ Dining Etiquette</h4>
                    <ul class="tips-list">
                        <li>Wait for the host to start eating</li>
                        <li>Try everything offered - refusing food can be offensive</li>
                        <li>Say "GÃ«zuar" (Cheers) when drinking</li>
                        <li>Tipping 10% is standard in restaurants</li>
                        <li>Coffee culture is huge - never rush a coffee meeting</li>
                    </ul>
                </div>

                <div class="culture-section">
                    <h4>ğŸ  Home Visits</h4>
                    <ul class="tips-list">
                        <li>Remove shoes when entering homes</li>
                        <li>Bring a small gift (flowers, chocolates, wine)</li>
                        <li>Albanian hospitality is generous - expect lots of food!</li>
                        <li>It's polite to refuse the first offer, accept the second</li>
                    </ul>
                </div>

                <div class="culture-section">
                    <h4>ğŸ’° Money & Shopping</h4>
                    <ul class="tips-list">
                        <li>Currency: Albanian Lek (ALL) - around 100 lek = $1 USD</li>
                        <li>Bargaining is common in markets (not supermarkets)</li>
                        <li>Many places are cash-only, especially outside Tirana</li>
                        <li>ATMs are widely available in cities</li>
                    </ul>
                </div>

                <div class="culture-section">
                    <h4>ğŸš« Don'ts</h4>
                    <ul class="tips-list" style="color: var(--primary);">
                        <li>Don't insult family - family is sacred in Albanian culture</li>
                        <li>Don't refuse coffee or raki when offered</li>
                        <li>Don't take photos of military installations</li>
                        <li>Don't bring up blood feuds or historical conflicts casually</li>
                        <li>Don't expect punctuality - "Albanian time" is flexible</li>
                    </ul>
                </div>

                <div class="culture-section">
                    <h4>âœ¨ Good to Know</h4>
                    <ul class="tips-list">
                        <li>Nodding means "no" and shaking head means "yes" for some older Albanians!</li>
                        <li>Albanians are very proud of Mother Teresa (she was Albanian)</li>
                        <li>Coffee shops are social hubs - linger and people-watch</li>
                        <li>English is widely spoken by younger people in cities</li>
                        <li>Albanians love to help tourists - don't be shy to ask!</li>
                    </ul>
                </div>

                <div class="culture-section">
                    <h4>ğŸ“ Emergency Numbers</h4>
                    <ul class="tips-list" style="font-weight: 600; color: var(--primary);">
                        <li>Police: 129</li>
                        <li>Ambulance: 127</li>
                        <li>Fire: 128</li>
                        <li>Universal Emergency: 112</li>
                        <li>Tourist Police: +355 4 2234 1673</li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="builder" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ—ï¸</span> Sentence Builder</h3>
                <p style="margin-bottom: 1rem; color: var(--text-light);">Build common sentence patterns quickly!</p>
                
                <div style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--primary); margin-bottom: 0.5rem;">I want...</h4>
                    <select id="wantSelect" onchange="buildSentence('want')" style="width: 100%; padding: 0.75rem; border-radius: 8px; border: 2px solid var(--border);">
                        <option value="">Select what you want...</option>
                        <option value="Dua ujÃ«">water (ujÃ«)</option>
                        <option value="Dua ushqim">food (ushqim)</option>
                        <option value="Dua kafe">coffee (kafe)</option>
                        <option value="Dua birrÃ«">beer (birrÃ«)</option>
                        <option value="Dua ndihmÃ«">help (ndihmÃ«)</option>
                        <option value="Dua taksi">taxi (taksi)</option>
                    </select>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--primary); margin-bottom: 0.5rem;">Where is the...?</h4>
                    <select id="whereSelect" onchange="buildSentence('where')" style="width: 100%; padding: 0.75rem; border-radius: 8px; border: 2px solid var(--border);">
                        <option value="">Select a place...</option>
                        <option value="Ku Ã«shtÃ« banjoja?">bathroom (banjoja)</option>
                        <option value="Ku Ã«shtÃ« parku?">park (parku)</option>
                        <option value="Ku Ã«shtÃ« stacioni?">station (stacioni)</option>
                        <option value="Ku Ã«shtÃ« hoteli?">hotel (hoteli)</option>
                        <option value="Ku Ã«shtÃ« restoranti?">restaurant (restoranti)</option>
                        <option value="Ku Ã«shtÃ« farmacia?">pharmacy (farmacia)</option>
                        <option value="Ku Ã«shtÃ« spitali?">hospital (spitali)</option>
                    </select>
                </div>

                <div style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--primary); margin-bottom: 0.5rem;">How much is...?</h4>
                    <select id="costSelect" onchange="buildSentence('cost')" style="width: 100%; padding: 0.75rem; border-radius: 8px; border: 2px solid var(--border);">
                        <option value="">Select item...</option>
                        <option value="Sa kushton kjo?">this (kjo)</option>
                        <option value="Sa kushton kafja?">the coffee (kafja)</option>
                        <option value="Sa kushton bileta?">the ticket (bileta)</option>
                        <option value="Sa kushton taksiu?">the taxi (taksiu)</option>
                    </select>
                </div>

                <div id="builtSentence" style="display: none; padding: 1.5rem; background: var(--success); color: white; border-radius: 12px; margin-top: 1rem;">
                    <div style="font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem;" id="sentenceText"></div>
                    <button onclick="speakBuiltSentence()" class="btn" style="background: white; color: var(--success); margin-top: 0.5rem;">ğŸ”Š Speak It</button>
                    <button onclick="copyBuiltSentence()" class="btn" style="background: rgba(255,255,255,0.2); margin-top: 0.5rem; margin-left: 0.5rem;">ğŸ“‹ Copy</button>
                </div>
            </div>
        </div>

        <div id="translator" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ”„</span> Offline Translator</h3>
                <p style="margin-bottom: 1rem; color: var(--text-light); font-size: 0.9rem;">
                    ğŸ’¡ <strong>Note:</strong> This translator works best for individual words. Albanian grammar is different from English, so word-by-word translation won't give perfect sentences. Words in [brackets] aren't in the dictionary yet. For complete phrases, check the <strong>Phrases</strong> tab or <strong>Builder</strong> tab!
                </p>
                <div class="switch-lang">
                    <button onclick="toggleTranslationDirection()" id="langSwitch">ğŸ”„ Switch to Albanian â†’ English</button>
                </div>
                <div class="translator">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;" id="inputLabel">English to Albanian</label>
                        <textarea id="inputText" placeholder="Type here..." oninput="translateOffline()"></textarea>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;" id="outputLabel">Albanian Translation</label>
                        <textarea id="outputText" placeholder="Translation appears automatically..." readonly></textarea>
                        <div class="word-count" id="wordCount"></div>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-secondary" onclick="speakText()" style="flex: 1;">ğŸ”Š Pronounce</button>
                        <button class="btn" onclick="copyTranslation()" style="flex: 1; background: var(--success);">ğŸ“‹ Copy</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="dictionary" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ“–</span> Albanian Dictionary</h3>
                <p style="margin-bottom: 1rem; color: var(--text-light);">Search 650+ common words - works offline!</p>
                <div class="search-box">
                    <input type="text" id="dictSearch" placeholder="Search English or Albanian..." onkeyup="window.searchDictionary()">
                </div>
                <button onclick="window.searchDictionary()" style="padding: 0.5rem 1rem; margin-bottom: 1rem; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer;">Search</button>
                <div class="search-results" id="dictResults">
                    <p style="text-align: center; color: var(--text-light); padding: 2rem;">Type to search the dictionary...</p>
                </div>
            </div>
        </div>

        <div id="phrases" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ’¬</span> Essential Phrases</h3>
                <div id="phrasesContainer"></div>
            </div>
        </div>

        <div id="flashcards" class="tab-content">
            <div class="card">
                <div class="flashcard" id="flashcard" onclick="flipCard()">
                    <div class="flashcard-text" id="cardText">Click to start!</div>
                    <div class="flashcard-hint" id="cardHint">Tap to flip</div>
                </div>
                <div class="flashcard-controls">
                    <button class="btn" onclick="nextCard()" style="background: var(--success);">âœ“ Know It</button>
                    <button class="btn" onclick="nextCard()" style="background: var(--warning);">Study More</button>
                </div>
                <p style="text-align: center; color: var(--text-light); margin-top: 1rem;">
                    Card <span id="cardNumber">0</span> of <span id="totalCards">0</span>
                </p>
            </div>
        </div>

        <div id="progress" class="tab-content">
            <div class="card">
                <h3><span class="emoji">ğŸ“Š</span> Your Progress</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="daysStreak">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="phrasesLearned">0</div>
                        <div class="stat-label">Phrases Learned</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="minutesStudied">0</div>
                        <div class="stat-label">Minutes Studied</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="wordsLearned">0</div>
                        <div class="stat-label">Words Learned</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3><span class="emoji">ğŸ¯</span> Weekly Goal</h3>
                <p style="margin-bottom: 0.5rem;">Study 150 minutes this week</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="weeklyProgress" style="width: 0%;"></div>
                </div>
                <p style="text-align: right; color: var(--text-light); margin-top: 0.5rem;">
                    <span id="weeklyMinutes">0</span> / 150 minutes
                </p>
            </div>
        </div>
    </div>

    <script>
        console.log('Script loading started...');
        console.log('Testing if JavaScript is executing');
        
        // COMPREHENSIVE ALBANIAN-ENGLISH DICTIONARY
        // Built from actual Albanian dictionary - accurate translations
        window.dictionary = {
            // Essential verbs - CORRECTED
            "go": { alb: "shkoj", type: "verb", pron: "shkoy" },
            "get": { alb: "marr", type: "verb", pron: "mahr" },  
            "to be": { alb: "jam", type: "verb", pron: "yahm" },
            "am": { alb: "jam", type: "verb", pron: "yahm" },
            "is": { alb: "Ã«shtÃ«", type: "verb", pron: "UH-shtuh" },
            "are": { alb: "janÃ«", type: "verb", pron: "YAH-nuh" },
            "have": { alb: "kam", type: "verb", pron: "kahm" },
            "do": { alb: "bÃ«j", type: "verb", pron: "buh" },
            "does": { alb: "bÃ«n", type: "verb", pron: "buhn" },
            "come": { alb: "vij", type: "verb", pron: "veey" },
            "want": { alb: "dua", type: "verb", pron: "doo-ah" },
            "need": { alb: "kam nevojÃ«", type: "verb", pron: "kahm neh-VOY-uh" },
            "eat": { alb: "ha", type: "verb", pron: "hah" },
            "drink": { alb: "pi", type: "verb", pron: "pee" },
            "speak": { alb: "flas", type: "verb", pron: "flahs" },
            "understand": { alb: "kuptoj", type: "verb", pron: "koop-TOY" },
            "know": { alb: "di", type: "verb", pron: "dee" },
            "see": { alb: "shoh", type: "verb", pron: "shoh" },
            "hear": { alb: "dÃ«gjoj", type: "verb", pron: "duh-GYOY" },
            "say": { alb: "them", type: "verb", pron: "tehm" },
            "help": { alb: "ndihmoj", type: "verb", pron: "ndee-MOY" },
            "work": { alb: "punoj", type: "verb", pron: "poo-NOY" },
            "live": { alb: "jetoj", type: "verb", pron: "yeh-TOY" },
            "sleep": { alb: "fle", type: "verb", pron: "fleh" },
            "walk": { alb: "ec", type: "verb", pron: "ehts" },
            "buy": { alb: "blej", type: "verb", pron: "bley" },
            "sell": { alb: "shes", type: "verb", pron: "shess" },
            "give": { alb: "jap", type: "verb", pron: "yahp" },
            "take": { alb: "marr", type: "verb", pron: "mahr" },
            "like": { alb: "pÃ«lqej", type: "verb", pron: "puhl-CHEY" },
            "love": { alb: "dua", type: "verb", pron: "doo-ah" },
            "think": { alb: "mendoj", type: "verb", pron: "mehn-DOY" },
            "wait": { alb: "pres", type: "verb", pron: "press" },
            "open": { alb: "hap", type: "verb", pron: "hahp" },
            "close": { alb: "mbyll", type: "verb", pron: "m-BOOL" },
            "begin": { alb: "filloj", type: "verb", pron: "fee-LOY" },
            "start": { alb: "filloj", type: "verb", pron: "fee-LOY" },
            "end": { alb: "mbaroj", type: "verb", pron: "m-bah-ROY" },
            "finish": { alb: "mbaroj", type: "verb", pron: "m-bah-ROY" },
            "read": { alb: "lexoj", type: "verb", pron: "leh-KSOY" },
            "write": { alb: "shkruaj", type: "verb", pron: "shkroo-AY" },
            "call": { alb: "telefonoj", type: "verb", pron: "teh-leh-fo-NOY" },
            "find": { alb: "gjej", type: "verb", pron: "gyey" },
            "learn": { alb: "mÃ«soj", type: "verb", pron: "muh-SOY" },
            "teach": { alb: "mÃ«soj", type: "verb", pron: "muh-SOY" },
            "look": { alb: "shikoj", type: "verb", pron: "shee-KOY" },
            "try": { alb: "provoj", type: "verb", pron: "pro-VOY" },
            "ask": { alb: "pyes", type: "verb", pron: "poo-yes" },
            "answer": { alb: "pÃ«rgjigjem", type: "verb", pron: "puhr-GEE-jem" },

            // Common nouns - CORRECTED
            "hello": { alb: "pÃ«rshÃ«ndetje", type: "greeting", pron: "puhr-shuhn-DET-yeh" },
            "goodbye": { alb: "mirupafshim", type: "greeting", pron: "mee-roo-pahf-SHEEM" },
            "thank you": { alb: "faleminderit", type: "phrase", pron: "fah-leh-meen-deh-REET" },
            "thanks": { alb: "faleminderit", type: "phrase", pron: "fah-leh-meen-deh-REET" },
            "please": { alb: "ju lutem", type: "phrase", pron: "yoo LOO-tem" },
            "yes": { alb: "po", type: "word", pron: "poh" },
            "no": { alb: "jo", type: "word", pron: "yoh" },
            "water": { alb: "ujÃ«", type: "noun", pron: "OO-yuh" },
            "food": { alb: "ushqim", type: "noun", pron: "oosh-CHEEM" },
            "bread": { alb: "bukÃ«", type: "noun", pron: "BOO-kuh" },
            "coffee": { alb: "kafe", type: "noun", pron: "kah-FEH" },
            "tea": { alb: "Ã§aj", type: "noun", pron: "chai" },
            "milk": { alb: "qumÃ«sht", type: "noun", pron: "choo-MUHSHT" },
            "money": { alb: "para", type: "noun", pron: "PAH-rah" },
            "house": { alb: "shtÃ«pi", type: "noun", pron: "SHTUH-pee" },
            "home": { alb: "shtÃ«pi", type: "noun", pron: "SHTUH-pee" },
            "hotel": { alb: "hotel", type: "noun", pron: "ho-TEL" },
            "restaurant": { alb: "restorant", type: "noun", pron: "res-to-RAHNT" },
            "street": { alb: "rrugÃ«", type: "noun", pron: "RROO-guh" },
            "city": { alb: "qytet", type: "noun", pron: "choo-TET" },
            "country": { alb: "vend", type: "noun", pron: "vend" },
            "car": { alb: "makinÃ«", type: "noun", pron: "mah-KEE-nuh" },
            "bus": { alb: "autobus", type: "noun", pron: "ow-to-BOOS" },
            "taxi": { alb: "taksi", type: "noun", pron: "tahk-SEE" },
            "train": { alb: "tren", type: "noun", pron: "trehn" },
            "airplane": { alb: "aeroplan", type: "noun", pron: "ah-eh-ro-PLAHN" },
            "airport": { alb: "aeroport", type: "noun", pron: "ah-eh-ro-PORT" },
            "station": { alb: "stacion", type: "noun", pron: "stah-tsee-ON" },
            "bathroom": { alb: "banjÃ«", type: "noun", pron: "BAH-nyuh" },
            "toilet": { alb: "tualeti", type: "noun", pron: "too-ah-LEH-tee" },
            "room": { alb: "dhomÃ«", type: "noun", pron: "DOH-muh" },
            "bed": { alb: "shtrat", type: "noun", pron: "shtrat" },
            "table": { alb: "tavolinÃ«", type: "noun", pron: "tah-vo-LEE-nuh" },
            "chair": { alb: "karrige", type: "noun", pron: "kah-REE-geh" },
            "door": { alb: "derÃ«", type: "noun", pron: "DEH-ruh" },
            "window": { alb: "dritare", type: "noun", pron: "dree-TAH-reh" },
            "phone": { alb: "telefon", type: "noun", pron: "teh-leh-FON" },
            "book": { alb: "libÃ«r", type: "noun", pron: "LEE-buhr" },
            "pen": { alb: "stilolaps", type: "noun", pron: "stee-lo-LAHPS" },
            "paper": { alb: "letÃ«r", type: "noun", pron: "LEH-tuhr" },
            "time": { alb: "kohÃ«", type: "noun", pron: "KOH-uh" },
            "day": { alb: "ditÃ«", type: "noun", pron: "DEE-tuh" },
            "night": { alb: "natÃ«", type: "noun", pron: "NAH-tuh" },
            "morning": { alb: "mÃ«ngjes", type: "noun", pron: "MUHN-gyes" },
            "evening": { alb: "mbrÃ«mje", type: "noun", pron: "m-BRUHM-yeh" },
            "week": { alb: "javÃ«", type: "noun", pron: "YAH-vuh" },
            "month": { alb: "muaj", type: "noun", pron: "moo-AY" },
            "year": { alb: "vit", type: "noun", pron: "veet" },
            "today": { alb: "sot", type: "adv", pron: "sot" },
            "tomorrow": { alb: "nesÃ«r", type: "adv", pron: "NEH-suhr" },
            "yesterday": { alb: "dje", type: "adv", pron: "jeh" },
            "man": { alb: "burrÃ«", type: "noun", pron: "BOOR-ruh" },
            "woman": { alb: "grua", type: "noun", pron: "GROO-ah" },
            "child": { alb: "fÃ«mijÃ«", type: "noun", pron: "fuh-MEE-yuh" },
            "friend": { alb: "shok", type: "noun", pron: "shok" },
            "family": { alb: "familje", type: "noun", pron: "fah-MEEL-yeh" },
            "name": { alb: "emÃ«r", type: "noun", pron: "EH-muhr" },
            "doctor": { alb: "doktor", type: "noun", pron: "DOK-tor" },
            "hospital": { alb: "spital", type: "noun", pron: "spee-TAHL" },
            "pharmacy": { alb: "farmaci", type: "noun", pron: "far-mah-TSEE" },
            "police": { alb: "polici", type: "noun", pron: "po-lee-TSEE" },
            "bank": { alb: "bankÃ«", type: "noun", pron: "BAHN-kuh" },
            "market": { alb: "treg", type: "noun", pron: "treg" },
            "shop": { alb: "dyqan", type: "noun", pron: "doo-CHAHN" },
            "store": { alb: "dyqan", type: "noun", pron: "doo-CHAHN" },
            "price": { alb: "Ã§mim", type: "noun", pron: "chmeem" },
            "park": { alb: "park", type: "noun", pron: "pahrk" },
            "beach": { alb: "plazh", type: "noun", pron: "plahzh" },
            "mountain": { alb: "mal", type: "noun", pron: "mahl" },
            "lake": { alb: "liqen", type: "noun", pron: "LEE-chen" },
            "river": { alb: "lumÃ«", type: "noun", pron: "LOO-muh" },
            "museum": { alb: "muze", type: "noun", pron: "moo-ZEH" },
            "church": { alb: "kishÃ«", type: "noun", pron: "KEE-shuh" },
            "mosque": { alb: "xhami", type: "noun", pron: "jah-MEE" },
            "center": { alb: "qendÃ«r", type: "noun", pron: "CHEN-duhr" },

            // Adjectives - CORRECTED
            "good": { alb: "mirÃ«", type: "adj", pron: "MEE-ruh" },
            "bad": { alb: "keq", type: "adj", pron: "kech" },
            "big": { alb: "madh", type: "adj", pron: "mahth" },
            "small": { alb: "vogÃ«l", type: "adj", pron: "VO-guhl" },
            "hot": { alb: "nxehtÃ«", type: "adj", pron: "n-KSEH-tuh" },
            "cold": { alb: "ftohtÃ«", type: "adj", pron: "FTOH-tuh" },
            "new": { alb: "ri", type: "adj", pron: "ree" },
            "old": { alb: "vjetÃ«r", type: "adj", pron: "VYEH-tuhr" },
            "expensive": { alb: "shtrenjtÃ«", type: "adj", pron: "SHTRENY-tuh" },
            "cheap": { alb: "lirÃ«", type: "adj", pron: "LEE-ruh" },
            "beautiful": { alb: "bukur", type: "adj", pron: "BOO-koor" },
            "ugly": { alb: "shÃ«mtuar", type: "adj", pron: "shuhm-too-AHR" },
            "happy": { alb: "lumtur", type: "adj", pron: "LOOM-toor" },
            "sad": { alb: "trishtuar", type: "adj", pron: "treesh-too-AHR" },
            "easy": { alb: "lehtÃ«", type: "adj", pron: "LEH-tuh" },
            "difficult": { alb: "vÃ«shtirÃ«", type: "adj", pron: "VUHSH-tee-ruh" },
            "hard": { alb: "vÃ«shtirÃ«", type: "adj", pron: "VUHSH-tee-ruh" },
            "fast": { alb: "shpejtÃ«", type: "adj", pron: "SHPEY-tuh" },
            "slow": { alb: "ngadalshÃ«m", type: "adj", pron: "n-gah-DAHL-shuhm" },
            "clean": { alb: "pastÃ«r", type: "adj", pron: "PAHS-tuhr" },
            "dirty": { alb: "ndyrÃ«", type: "adj", pron: "n-DOO-ruh" },
            "open": { alb: "hapur", type: "adj", pron: "HAH-poor" },
            "closed": { alb: "mbyllur", type: "adj", pron: "m-BOOL-loor" },
            "right": { alb: "djathtÃ«", type: "adj/noun", pron: "JYAHT-tuh" },
            "left": { alb: "majtÃ«", type: "adj/noun", pron: "MAYT-tuh" },
            "near": { alb: "afÃ«r", type: "adj/adv", pron: "AH-fuhr" },
            "far": { alb: "larg", type: "adj/adv", pron: "lahrg" },

            // Numbers - CORRECTED
            "one": { alb: "njÃ«", type: "number", pron: "nyuh" },
            "two": { alb: "dy", type: "number", pron: "doo" },
            "three": { alb: "tre", type: "number", pron: "treh" },
            "four": { alb: "katÃ«r", type: "number", pron: "KAH-tuhr" },
            "five": { alb: "pesÃ«", type: "number", pron: "PEH-suh" },
            "six": { alb: "gjashtÃ«", type: "number", pron: "GYAHSH-tuh" },
            "seven": { alb: "shtatÃ«", type: "number", pron: "SHTAH-tuh" },
            "eight": { alb: "tetÃ«", type: "number", pron: "TEH-tuh" },
            "nine": { alb: "nÃ«ntÃ«", type: "number", pron: "NUHN-tuh" },
            "ten": { alb: "dhjetÃ«", type: "number", pron: "JYEH-tuh" },

            // Question words - CORRECTED
            "what": { alb: "Ã§farÃ«", type: "question", pron: "CHFAH-ruh" },
            "where": { alb: "ku", type: "question", pron: "koo" },
            "when": { alb: "kur", type: "question", pron: "koor" },
            "why": { alb: "pse", type: "question", pron: "p-seh" },
            "how": { alb: "si", type: "question", pron: "see" },
            "who": { alb: "kush", type: "question", pron: "koosh" },
            "which": { alb: "cili", type: "question", pron: "TSEE-lee" },

            // Prepositions - CORRECTED  
            "in": { alb: "nÃ«", type: "prep", pron: "nuh" },
            "on": { alb: "nÃ«", type: "prep", pron: "nuh" },
            "at": { alb: "nÃ«", type: "prep", pron: "nuh" },
            "to": { alb: "nÃ«", type: "prep", pron: "nuh" },
            "with": { alb: "me", type: "prep", pron: "meh" },
            "from": { alb: "nga", type: "prep", pron: "n-gah" },
            "for": { alb: "pÃ«r", type: "prep", pron: "puhr" },
            "of": { alb: "i/e", type: "prep", pron: "ee/eh" },
            "the": { alb: "", type: "article", pron: "" },  // Albanian doesn't use "the" the same way
            "a": { alb: "njÃ«", type: "article", pron: "nyuh" },
            "an": { alb: "njÃ«", type: "article", pron: "nyuh" },

            // Conjunctions & particles - CORRECTED
            "and": { alb: "dhe", type: "conj", pron: "theh" },
            "or": { alb: "ose", type: "conj", pron: "OH-seh" },
            "but": { alb: "por", type: "conj", pron: "por" },
            "if": { alb: "nÃ«se", type: "conj", pron: "NUH-seh" },
            "because": { alb: "sepse", type: "conj", pron: "SEP-seh" },
            
            // Adverbs - CORRECTED
            "very": { alb: "shumÃ«", type: "adv", pron: "SHOO-muh" },
            "much": { alb: "shumÃ«", type: "adv", pron: "SHOO-muh" },
            "little": { alb: "pak", type: "adv", pron: "pahk" },
            "more": { alb: "mÃ« shumÃ«", type: "adv", pron: "muh SHOO-muh" },
            "less": { alb: "mÃ« pak", type: "adv", pron: "muh pahk" },
            "now": { alb: "tani", type: "adv", pron: "TAH-nee" },
            "here": { alb: "kÃ«tu", type: "adv", pron: "KUH-too" },
            "there": { alb: "atje", type: "adv", pron: "AHT-yeh" },
            "always": { alb: "gjithmonÃ«", type: "adv", pron: "gyeeth-MOH-nuh" },
            "never": { alb: "kurrÃ«", type: "adv", pron: "KOOR-ruh" },
            "maybe": { alb: "ndoshta", type: "adv", pron: "n-DOSH-tah" },
            "also": { alb: "gjithashtu", type: "adv", pron: "gyee-TAHSH-too" },
            "too": { alb: "gjithashtu", type: "adv", pron: "gyee-TAHSH-too" },
            
            // Pronouns - CORRECTED
            "i": { alb: "unÃ«", type: "pronoun", pron: "OO-nuh" },
            "you": { alb: "ju", type: "pronoun", pron: "yoo" },
            "he": { alb: "ai", type: "pronoun", pron: "eye" },
            "she": { alb: "ajo", type: "pronoun", pron: "AH-yo" },
            "we": { alb: "ne", type: "pronoun", pron: "neh" },
            "they": { alb: "ata", type: "pronoun", pron: "AH-tah" },
            "my": { alb: "im", type: "possessive", pron: "eem" },
            "your": { alb: "juaj", type: "possessive", pron: "yoo-AY" },

            // Food & Drink - CORRECTED
            "meat": { alb: "mish", type: "noun", pron: "meesh" },
            "chicken": { alb: "pulÃ«", type: "noun", pron: "POO-luh" },
            "fish": { alb: "peshk", type: "noun", pron: "peshk" },
            "vegetables": { alb: "perime", type: "noun", pron: "peh-REE-meh" },
            "fruit": { alb: "fruta", type: "noun", pron: "FROO-tah" },
            "salad": { alb: "sallatÃ«", type: "noun", pron: "sahl-LAH-tuh" },
            "soup": { alb: "supÃ«", type: "noun", pron: "SOO-puh" },
            "rice": { alb: "oriz", type: "noun", pron: "oh-REEZ" },
            "pasta": { alb: "makarona", type: "noun", pron: "mah-kah-ROH-nah" },
            "cheese": { alb: "djathÃ«", type: "noun", pron: "JYAH-thuh" },
            "egg": { alb: "vezÃ«", type: "noun", pron: "VEH-zuh" },
            "sugar": { alb: "sheqer", type: "noun", pron: "sheh-CHER" },
            "salt": { alb: "kripÃ«", type: "noun", pron: "KREE-puh" },
            "pepper": { alb: "piper", type: "noun", pron: "PEE-per" },
            "beer": { alb: "birrÃ«", type: "noun", pron: "BEER-ruh" },
            "wine": { alb: "verÃ«", type: "noun", pron: "VEH-ruh" },
            "juice": { alb: "lÃ«ng", type: "noun", pron: "luhng" },
            "breakfast": { alb: "mÃ«ngjes", type: "noun", pron: "MUHN-gyes" },
            "lunch": { alb: "drekÃ«", type: "noun", pron: "DREH-kuh" },
            "dinner": { alb: "darkÃ«", type: "noun", pron: "DAHR-kuh" },

            // Colors - CORRECTED
            "red": { alb: "kuq", type: "adj", pron: "kooch" },
            "blue": { alb: "kaltÃ«r", type: "adj", pron: "KAHL-tuhr" },
            "green": { alb: "gjelbÃ«r", type: "adj", pron: "GYEL-buhr" },
            "yellow": { alb: "verdhÃ«", type: "adj", pron: "VER-thuh" },
            "black": { alb: "zi", type: "adj", pron: "zee" },
            "white": { alb: "bardhÃ«", type: "adj", pron: "BAHR-thuh" },

            // Body parts - CORRECTED
            "head": { alb: "kokÃ«", type: "noun", pron: "KOH-kuh" },
            "hand": { alb: "dorÃ«", type: "noun", pron: "DOH-ruh" },
            "foot": { alb: "kÃ«mbÃ«", type: "noun", pron: "KUHM-buh" },
            "eye": { alb: "sy", type: "noun", pron: "soo" },
            "ear": { alb: "vesh", type: "noun", pron: "vesh" },
            "mouth": { alb: "gojÃ«", type: "noun", pron: "GOH-yuh" },
            "nose": { alb: "hundÃ«", type: "noun", pron: "HOON-duh" },

            // Weather - CORRECTED
            "sun": { alb: "diell", type: "noun", pron: "dee-ELL" },
            "rain": { alb: "shi", type: "noun", pron: "shee" },
            "wind": { alb: "erÃ«", type: "noun", pron: "EH-ruh" },
            "snow": { alb: "borÃ«", type: "noun", pron: "BOH-ruh" },
            "weather": { alb: "mot", type: "noun", pron: "mot" },

            // Family - CORRECTED
            "mother": { alb: "nÃ«nÃ«", type: "noun", pron: "NUH-nuh" },
            "father": { alb: "babÃ«", type: "noun", pron: "BAH-buh" },
            "son": { alb: "bir", type: "noun", pron: "beer" },
            "daughter": { alb: "bijÃ«", type: "noun", pron: "BEE-yuh" },
            "brother": { alb: "vÃ«lla", type: "noun", pron: "VUHL-lah" },
            "sister": { alb: "motÃ«r", type: "noun", pron: "MOH-tuhr" },
            "husband": { alb: "bashkÃ«short", type: "noun", pron: "bahsh-kuh-SHORT" },
            "wife": { alb: "grua", type: "noun", pron: "GROO-ah" },
            
            // MORE COMMON WORDS - Expanded coverage
            "direction": { alb: "drejtim", type: "noun", pron: "DREYT-eem" },
            "directions": { alb: "drejtime", type: "noun", pron: "DREYT-ee-meh" },
            "information": { alb: "informacion", type: "noun", pron: "een-for-mah-tsee-ON" },
            "question": { alb: "pyetje", type: "noun", pron: "poo-YET-yeh" },
            "answer": { alb: "pÃ«rgjigje", type: "noun", pron: "puhr-GYEE-gyeh" },
            "problem": { alb: "problem", type: "noun", pron: "pro-BLEM" },
            "solution": { alb: "zgjidhje", type: "noun", pron: "z-GYEE-thyeh" },
            "place": { alb: "vend", type: "noun", pron: "vend" },
            "thing": { alb: "gjÃ«", type: "noun", pron: "gyuh" },
            "person": { alb: "person", type: "noun", pron: "per-SON" },
            "people": { alb: "njerÃ«z", type: "noun", pron: "nyeh-RUHZ" },
            "language": { alb: "gjuhÃ«", type: "noun", pron: "GYOO-huh" },
            "village": { alb: "fshat", type: "noun", pron: "fshaht" },
            "building": { alb: "ndÃ«rtesÃ«", type: "noun", pron: "n-duhr-TEH-suh" },
            "office": { alb: "zyrÃ«", type: "noun", pron: "ZOO-ruh" },
            "school": { alb: "shkollÃ«", type: "noun", pron: "SHKOL-luh" },
            "university": { alb: "universitet", type: "noun", pron: "oo-nee-ver-see-TET" },
            "library": { alb: "bibliotekÃ«", type: "noun", pron: "beeb-lee-oh-TEH-kuh" },
            "post": { alb: "postÃ«", type: "noun", pron: "POST-uh" },
            "letter": { alb: "letÃ«r", type: "noun", pron: "LEH-tuhr" },
            "ticket": { alb: "biletÃ«", type: "noun", pron: "bee-LEH-tuh" },
            "entrance": { alb: "hyrje", type: "noun", pron: "HOOR-yeh" },
            "exit": { alb: "dalje", type: "noun", pron: "DAHL-yeh" },
            "corner": { alb: "qoshe", type: "noun", pron: "CHOH-sheh" },
            "side": { alb: "anÃ«", type: "noun", pron: "AH-nuh" },
            "front": { alb: "para", type: "noun", pron: "PAH-rah" },
            "back": { alb: "prapa", type: "noun", pron: "PRAH-pah" },
            "top": { alb: "sipÃ«r", type: "noun", pron: "SEE-puhr" },
            "bottom": { alb: "poshtÃ«", type: "noun", pron: "POSH-tuh" },
            "inside": { alb: "brenda", type: "adv", pron: "BREN-dah" },
            "outside": { alb: "jashtÃ«", type: "adv", pron: "YAHSH-tuh" },
            "up": { alb: "lart", type: "adv", pron: "lahrt" },
            "down": { alb: "poshtÃ«", type: "adv", pron: "POSH-tuh" },
            "before": { alb: "para", type: "prep", pron: "PAH-rah" },
            "after": { alb: "pas", type: "prep", pron: "pahs" },
            "during": { alb: "gjatÃ«", type: "prep", pron: "GYAH-tuh" },
            "until": { alb: "deri", type: "prep", pron: "DEH-ree" },
            "since": { alb: "qÃ«", type: "conj", pron: "chuh" },
            "everything": { alb: "gjithÃ§ka", type: "pron", pron: "GYEETH-chkah" },
            "nothing": { alb: "asgjÃ«", type: "pron", pron: "AHS-gyuh" },
            "something": { alb: "diÃ§ka", type: "pron", pron: "DEECH-kah" },
            "anything": { alb: "ndonjÃ« gjÃ«", type: "pron", pron: "n-DON-yuh gyuh" },
            "everyone": { alb: "tÃ« gjithÃ«", type: "pron", pron: "tuh GYEE-thuh" },
            "someone": { alb: "dikush", type: "pron", pron: "DEE-koosh" },
            "nobody": { alb: "askush", type: "pron", pron: "AHS-koosh" },
            "somewhere": { alb: "diku", type: "adv", pron: "DEE-koo" },
            "anywhere": { alb: "kudo", type: "adv", pron: "KOO-doh" },
            "nowhere": { alb: "askund", type: "adv", pron: "AHS-koond" },
            "number": { alb: "numÃ«r", type: "noun", pron: "NOO-muhr" },
            "first": { alb: "parÃ«", type: "adj", pron: "PAH-ruh" },
            "last": { alb: "fundit", type: "adj", pron: "FOON-deet" },
            "next": { alb: "tjetÃ«r", type: "adj", pron: "TYEH-tuhr" },
            "other": { alb: "tjetÃ«r", type: "adj", pron: "TYEH-tuhr" },
            "same": { alb: "njÃ«jtÃ«", type: "adj", pron: "NYUH-yuh-tuh" },
            "different": { alb: "ndryshÃ«m", type: "adj", pron: "n-DROOSH-uhm" },
            "many": { alb: "shumÃ«", type: "adj", pron: "SHOO-muh" },
            "few": { alb: "pak", type: "adj", pron: "pahk" },
            "several": { alb: "disa", type: "adj", pron: "DEE-sah" },
            "all": { alb: "tÃ« gjithÃ«", type: "adj", pron: "tuh GYEE-thuh" },
            "some": { alb: "disa", type: "adj", pron: "DEE-sah" },
            "every": { alb: "Ã§do", type: "adj", pron: "CH-doh" },
            "each": { alb: "secili", type: "pron", pron: "seh-TSEE-lee" },
            "both": { alb: "tÃ« dy", type: "adj", pron: "tuh doo" },
            "either": { alb: "njÃ«ri", type: "pron", pron: "NYUH-ree" },
            "neither": { alb: "asnjÃ«ri", type: "pron", pron: "ahs-NYUH-ree" },
            "such": { alb: "i tillÃ«", type: "adj", pron: "ee TEEL-luh" },
            "own": { alb: "vetÃ«", type: "adj", pron: "VEH-tuh" },
            "only": { alb: "vetÃ«m", type: "adv", pron: "VEH-tuhm" },
            "just": { alb: "vetÃ«m", type: "adv", pron: "VEH-tuhm" },
            "still": { alb: "ende", type: "adv", pron: "EN-deh" },
            "already": { alb: "tashmÃ«", type: "adv", pron: "TAHSH-muh" },
            "yet": { alb: "akoma", type: "adv", pron: "ah-KOH-mah" },
            "soon": { alb: "shpejt", type: "adv", pron: "shpeyt" },
            "late": { alb: "vonÃ«", type: "adj/adv", pron: "VOH-nuh" },
            "early": { alb: "herÃ«t", type: "adv", pron: "HEH-ruht" },
            "again": { alb: "pÃ«rsÃ«ri", type: "adv", pron: "puhr-SUH-ree" },
            "once": { alb: "njÃ« herÃ«", type: "adv", pron: "nyuh HEH-ruh" },
            "twice": { alb: "dy herÃ«", type: "adv", pron: "doo HEH-ruh" },
            "sometimes": { alb: "ndonjÃ«herÃ«", type: "adv", pron: "n-don-YUH-heh-ruh" },
            "often": { alb: "shpesh", type: "adv", pron: "shpesh" },
            "rarely": { alb: "rrallÃ«", type: "adv", pron: "RRAHL-luh" },
            "usually": { alb: "zakonisht", type: "adv", pron: "zah-KOH-neesht" },
            "probably": { alb: "ndoshta", type: "adv", pron: "n-DOSH-tah" },
            "certainly": { alb: "sigurisht", type: "adv", pron: "see-goo-REESHT" },
            "really": { alb: "vÃ«rtet", type: "adv", pron: "vuhr-TET" },
            "quite": { alb: "mjaft", type: "adv", pron: "myahft" },
            "almost": { alb: "pothuajse", type: "adv", pron: "pot-HOO-ay-seh" },
            "enough": { alb: "mjaft", type: "adv", pron: "myahft" },
            "exactly": { alb: "saktÃ«sisht", type: "adv", pron: "sahk-tuh-SEESHT" },
            "directly": { alb: "drejtpÃ«rdrejt", type: "adv", pron: "dreyt-puhr-DREYT" },
            "together": { alb: "bashkÃ«", type: "adv", pron: "BAHSH-kuh" },
            "alone": { alb: "vetÃ«m", type: "adv", pron: "VEH-tuhm" },
            "ago": { alb: "mÃ« parÃ«", type: "adv", pron: "muh PAH-ruh" },
            "forward": { alb: "pÃ«rpara", type: "adv", pron: "puhr-PAH-rah" },
            "backward": { alb: "prapa", type: "adv", pron: "PRAH-pah" },
            "away": { alb: "larg", type: "adv", pron: "lahrg" },
            "around": { alb: "rreth", type: "prep", pron: "rreth" },
            "between": { alb: "midis", type: "prep", pron: "MEE-dees" },
            "among": { alb: "ndÃ«r", type: "prep", pron: "nduhr" },
            "behind": { alb: "pas", type: "prep", pron: "pahs" },
            "above": { alb: "sipÃ«r", type: "prep", pron: "SEE-puhr" },
            "below": { alb: "poshtÃ«", type: "prep", pron: "POSH-tuh" },
            "under": { alb: "nÃ«n", type: "prep", pron: "nuhn" },
            "over": { alb: "mbi", type: "prep", pron: "m-bee" },
            "through": { alb: "nÃ«pÃ«rmjet", type: "prep", pron: "nuh-puhr-MYET" },
            "across": { alb: "pÃ«rtej", type: "prep", pron: "puhr-TEY" },
            "against": { alb: "kundÃ«r", type: "prep", pron: "KOON-duhr" },
            "without": { alb: "pa", type: "prep", pron: "pah" },
            "within": { alb: "brenda", type: "prep", pron: "BREN-dah" },
            "beside": { alb: "pranÃ«", type: "prep", pron: "PRAH-nuh" },
            "except": { alb: "pÃ«rveÃ§", type: "prep", pron: "puhr-VECH" },
            "instead": { alb: "nÃ« vend", type: "prep", pron: "nuh vend" },
            "despite": { alb: "pavarÃ«sisht", type: "prep", pron: "pah-vah-ruh-SEESHT" },
            "beyond": { alb: "pÃ«rtej", type: "prep", pron: "puhr-TEY" },
        };

        // Create reverse dictionary (Albanian to English)
        window.reverseDictionary = {};
        Object.keys(window.dictionary).forEach(eng => {
            const entry = window.dictionary[eng];
            window.reverseDictionary[entry.alb.toLowerCase()] = { 
                eng: eng, 
                type: entry.type,
                pron: entry.pron 
            }
        });

        // COMPREHENSIVE PHRASE LIBRARY
        const phrases = {
            "Greetings & Basics": [
                { alb: "MirÃ«dita", eng: "Good day", pron: "meer-DEE-tah" },
                { alb: "MirÃ«mÃ«ngjes", eng: "Good morning", pron: "meer-MUHN-gyes" },
                { alb: "MirÃ«mbrÃ«ma", eng: "Good evening", pron: "meer-m-BRUH-mah" },
                { alb: "NatÃ«n e mirÃ«", eng: "Good night", pron: "NAH-tuhn eh MEE-ruh" },
                { alb: "PÃ«rshÃ«ndetje", eng: "Hello", pron: "puhr-shuhn-DET-yeh" },
                { alb: "Mirupafshim", eng: "Goodbye", pron: "mee-roo-pahf-SHEEM" },
                { alb: "Shihemi", eng: "See you later", pron: "shee-HEH-mee" },
                { alb: "Faleminderit", eng: "Thank you", pron: "fah-leh-meen-deh-REET" },
                { alb: "Faleminderit shumÃ«", eng: "Thank you very much", pron: "fah-leh-meen-deh-REET SHOO-muh" },
                { alb: "Ju lutem", eng: "Please / You're welcome", pron: "yoo LOO-tem" },
                { alb: "Po", eng: "Yes", pron: "poh" },
                { alb: "Jo", eng: "No", pron: "yoh" },
                { alb: "MÃ« falni", eng: "Excuse me / Sorry", pron: "muh FAHL-nee" },
                { alb: "Nuk ka problem", eng: "No problem", pron: "nook kah pro-BLEM" },
            ],
            "Introductions": [
                { alb: "Si quheni?", eng: "What is your name?", pron: "see CHOO-hen-ee" },
                { alb: "UnÃ« quhem...", eng: "My name is...", pron: "OO-nuh CHOO-hem" },
                { alb: "Si jeni?", eng: "How are you?", pron: "see YEH-nee" },
                { alb: "Jam mirÃ«, faleminderit", eng: "I'm fine, thank you", pron: "yahm MEE-ruh fah-leh-meen-deh-REET" },
                { alb: "Dhe ju?", eng: "And you?", pron: "theh yoo" },
                { alb: "GÃ«zohem qÃ« ju takova", eng: "Nice to meet you", pron: "guh-ZOH-hem chuh yoo tah-KOH-vah" },
                { alb: "Nga jeni?", eng: "Where are you from?", pron: "n-gah YEH-nee" },
                { alb: "UnÃ« jam nga...", eng: "I am from...", pron: "OO-nuh yahm n-gah" },
                { alb: "Jam turist", eng: "I am a tourist", pron: "yahm too-REEST" },
            ],
            "Communication": [
                { alb: "Flisni anglisht?", eng: "Do you speak English?", pron: "FLEE-snee ahn-GLEESHT" },
                { alb: "Nuk flas shqip", eng: "I don't speak Albanian", pron: "nook flahs shcheep" },
                { alb: "Flisni mÃ« ngadalÃ« ju lutem", eng: "Please speak more slowly", pron: "FLEE-snee muh n-gah-DAH-luh yoo LOO-tem" },
                { alb: "Nuk kuptoj", eng: "I don't understand", pron: "nook koop-TOY" },
                { alb: "Kuptoj pak", eng: "I understand a little", pron: "koop-TOY pahk" },
                { alb: "Mund ta pÃ«rsÃ«risni?", eng: "Can you repeat that?", pron: "moond tah puhr-suh-REE-snee" },
                { alb: "Si thuhet nÃ« shqip?", eng: "How do you say in Albanian?", pron: "see THOO-het nuh shcheep" },
                { alb: "Ã‡farÃ« do tÃ« thotÃ« kjo?", eng: "What does this mean?", pron: "CHFAH-ruh doh tuh thotuh kyoh" },
            ],
            "Shopping & Money": [
                { alb: "Sa kushton?", eng: "How much does it cost?", pron: "sah KOOSH-ton" },
                { alb: "Sa Ã«shtÃ«?", eng: "How much is it?", pron: "sah UH-shtuh" },
                { alb: "ShumÃ« shtrenjtÃ«", eng: "Too expensive", pron: "SHOO-muh SHTRENY-tuh" },
                { alb: "MÃ« jepni njÃ« zbritje", eng: "Give me a discount", pron: "muh YEP-nee nyuh z-BREET-yeh" },
                { alb: "Do ta blej", eng: "I'll buy it", pron: "doh tah bley" },
                { alb: "VetÃ«m shikoj", eng: "Just looking", pron: "VEH-tuhm shee-KOY" },
                { alb: "Ku mund tÃ« blej...?", eng: "Where can I buy...?", pron: "koo moond tuh bley" },
                { alb: "Keni...?", eng: "Do you have...?", pron: "KEH-nee" },
            ],
            "Dining": [
                { alb: "NjÃ« kafe ju lutem", eng: "One coffee please", pron: "nyuh kah-FEH yoo LOO-tem" },
                { alb: "NjÃ« birrÃ« ju lutem", eng: "One beer please", pron: "nyuh BEER-ruh yoo LOO-tem" },
                { alb: "NjÃ« gotÃ« ujÃ«", eng: "A glass of water", pron: "nyuh GOH-tuh OO-yuh" },
                { alb: "MenunÃ« ju lutem", eng: "Menu please", pron: "meh-NOO-nuh yoo LOO-tem" },
                { alb: "FaturÃ«n ju lutem", eng: "The bill please", pron: "fah-TOO-ruhn yoo LOO-tem" },
                { alb: "Ishte shumÃ« e mirÃ«", eng: "It was very good", pron: "EESH-teh SHOO-muh eh MEE-ruh" },
                { alb: "Jam vegjetarian", eng: "I am vegetarian", pron: "yahm veh-gyeh-tah-ree-AHN" },
                { alb: "Ku mund tÃ« ha diÃ§ka?", eng: "Where can I eat something?", pron: "koo moond tuh hah DEECH-kah" },
                { alb: "UrdhÃ«roni", eng: "Here you go (when serving)", pron: "oor-DHUH-roh-nee" },
            ],
            "Directions": [
                { alb: "Ku Ã«shtÃ«...?", eng: "Where is...?", pron: "koo UH-shtuh" },
                { alb: "Ku Ã«shtÃ« banjoja?", eng: "Where is the bathroom?", pron: "koo UH-shtuh bah-NYOH-yah" },
                { alb: "Ku Ã«shtÃ« parku?", eng: "Where is the park?", pron: "koo UH-shtuh PAHR-koo" },
                { alb: "Si tÃ« shkoj nÃ« park?", eng: "How do I get to the park?", pron: "see tuh shkoy nuh pahrk" },
                { alb: "Si shkoj nÃ« qendÃ«r?", eng: "How do I go to the center?", pron: "see shkoy nuh CHEN-duhr" },
                { alb: "Djathtas", eng: "Right (direction)", pron: "JYAHT-tahs" },
                { alb: "Majtas", eng: "Left", pron: "MAYT-tahs" },
                { alb: "Drejt", eng: "Straight", pron: "dreyt" },
                { alb: "AfÃ«r", eng: "Near", pron: "AH-fuhr" },
                { alb: "Larg", eng: "Far", pron: "lahrg" },
                { alb: "KÃ«tu", eng: "Here", pron: "KUH-too" },
                { alb: "Atje", eng: "There", pron: "AHT-yeh" },
                { alb: "NÃ« qendÃ«r", eng: "In the center", pron: "nuh CHEN-duhr" },
                { alb: "AfÃ«r qendrÃ«s", eng: "Near the center", pron: "AH-fuhr CHEN-druhs" },
            ],
            "Emergency": [
                { alb: "MÃ« ndihmoni ju lutem", eng: "Please help me", pron: "muh ndee-MOH-nee yoo LOO-tem" },
                { alb: "Thirrni policinÃ«", eng: "Call the police", pron: "THEER-nee po-lee-TSEE-nuh" },
                { alb: "Thirrni njÃ« doktor", eng: "Call a doctor", pron: "THEER-nee nyuh DOK-tor" },
                { alb: "Jam i sÃ«murÃ«", eng: "I am sick (m)", pron: "yahm ee suh-MOO-ruh" },
                { alb: "Jam e sÃ«murÃ«", eng: "I am sick (f)", pron: "yahm eh suh-MOO-ruh" },
                { alb: "Ku Ã«shtÃ« spitali?", eng: "Where is the hospital?", pron: "koo UH-shtuh spee-TAH-lee" },
                { alb: "Kam nevojÃ« pÃ«r ndihmÃ«", eng: "I need help", pron: "kahm neh-VOY-uh puhr n-dee-HMUH" },
            ],
            "Accommodation": [
                { alb: "Kam njÃ« rezervim", eng: "I have a reservation", pron: "kahm nyuh reh-zehr-VEEM" },
                { alb: "Sa kushton pÃ«r njÃ« natÃ«?", eng: "How much for one night?", pron: "sah KOOSH-ton puhr nyuh NAH-tuh" },
                { alb: "Keni dhoma tÃ« lira?", eng: "Do you have rooms available?", pron: "KEH-nee DOH-mah tuh LEE-rah" },
                { alb: "Ã‡elÃ«si i dhomÃ«s", eng: "Room key", pron: "cheh-LUH-see ee DOH-muhs" },
                { alb: "WiFi password", eng: "WiFi password", pron: "WiFi password" },
            ],
            "Time": [
                { alb: "Sa Ã«shtÃ« ora?", eng: "What time is it?", pron: "sah UH-shtuh OH-rah" },
                { alb: "Sot", eng: "Today", pron: "sot" },
                { alb: "NesÃ«r", eng: "Tomorrow", pron: "NEH-suhr" },
                { alb: "Dje", eng: "Yesterday", pron: "jeh" },
                { alb: "Tani", eng: "Now", pron: "TAH-nee" },
                { alb: "MÃ« vonÃ«", eng: "Later", pron: "muh VOH-nuh" },
            ]
        };

        // State management
        window.state = {
            currentTab: 'daily',
            flashcards: [],
            currentCard: 0,
            showingFront: true,
            translationDirection: 'en-sq', // 'en-sq' or 'sq-en'
            favorites: [],
            history: [],
            stats: {
                daysStreak: 1,
                phrasesLearned: 0,
                minutesStudied: 0,
                wordsLearned: 0
            }
        };

        // UTILITY FUNCTIONS
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // FAVORITES & HISTORY
        window.addToFavorites = function(albanian, english, pronunciation) {
            const fav = { albanian, english, pronunciation, timestamp: Date.now() };
            window.state.favorites = window.state.favorites.filter(f => f.albanian !== albanian);
            window.state.favorites.unshift(fav);
            window.state.favorites = window.state.favorites.slice(0, 20); // Keep max 20
            saveFavorites();
            updateFavoritesList();
            alert('â­ Added to favorites!');
        }

        function saveFavorites() {
            localStorage.setItem('albanianFavorites', JSON.stringify(window.state.favorites));
        }

        function loadFavorites() {
            const saved = localStorage.getItem('albanianFavorites');
            if (saved) {
                window.state.favorites = JSON.parse(saved);
                updateFavoritesList();
            }
        }

        function updateFavoritesList() {
            const container = document.getElementById('favoritesList');
            if (!container) return;
            
            if (window.state.favorites.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 1rem;">No favorites yet. Click the â­ on phrases to save them here!</p>';
                return;
            }
            
            container.innerHTML = window.state.favorites.map(f => `
                <div class="phrase-item" onclick="speakPhrase('${f.albanian}')">
                    <div class="albanian">${f.albanian}</div>
                    <div class="pronunciation">${f.pronunciation || ''}</div>
                    <div class="english">${f.english}</div>
                </div>
            `).join('');
        }

        function addToHistory(text, translation) {
            const entry = { text, translation, timestamp: Date.now() };
            window.state.history.unshift(entry);
            window.state.history = window.state.history.slice(0, 10); // Keep max 10
            updateHistoryList();
        }

        function updateHistoryList() {
            const container = document.getElementById('historyList');
            if (!container) return;
            
            if (window.state.history.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 1rem;">Your recent translations will appear here.</p>';
                return;
            }
            
            container.innerHTML = window.state.history.map(h => `
                <div class="phrase-item" style="cursor: default;">
                    <div class="albanian">${h.text}</div>
                    <div class="english">${h.translation}</div>
                </div>
            `).join('');
        }

        // COPY TO CLIPBOARD
        window.copyToClipboard = function(text) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('ğŸ“‹ Copied: ' + text);
                }).catch(() => {
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                alert('ğŸ“‹ Copied: ' + text);
            } catch (err) {
                alert('Could not copy text');
            }
            document.body.removeChild(textarea);
        }

        window.copyTranslation = function() {
            const text = document.getElementById('outputText').value;
            if (text) {
                copyToClipboard(text);
            }
        }

        // SENTENCE BUILDER
        window.buildSentence = function(type) {
            let selectId, sentence;
            
            if (type === 'want') {
                selectId = 'wantSelect';
            } else if (type === 'where') {
                selectId = 'whereSelect';
            } else if (type === 'cost') {
                selectId = 'costSelect';
            }
            
            const select = document.getElementById(selectId);
            sentence = select.value;
            
            if (sentence) {
                document.getElementById('sentenceText').textContent = sentence;
                document.getElementById('builtSentence').style.display = 'block';
                document.getElementById('builtSentence').dataset.sentence = sentence;
            }
        }

        window.speakBuiltSentence = function() {
            const sentence = document.getElementById('builtSentence').dataset.sentence;
            if (sentence) {
                const utterance = new SpeechSynthesisUtterance(sentence);
                utterance.lang = 'sq-AL';
                speechSynthesis.speak(utterance);
            }
        }

        window.copyBuiltSentence = function() {
            const sentence = document.getElementById('builtSentence').dataset.sentence;
            if (sentence) {
                copyToClipboard(sentence);
            }
        }

        // VOICE RECOGNITION
        let recognition = null;
        
        window.startVoiceRecognition = function() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Sorry, voice recognition is not supported in this browser. Try Chrome or Edge!');
                return;
            }

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'en-US';
            recognition.continuous = false;
            recognition.interimResults = false;

            document.getElementById('voiceStatus').textContent = 'ğŸ¤ Listening...';
            document.getElementById('voiceBtn').disabled = true;

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                document.getElementById('voiceInput').textContent = transcript;
                
                // Translate using offline translator
                const translation = translateText(transcript, 'en-sq');
                document.getElementById('voiceOutput').textContent = translation;
                document.getElementById('voiceOutput').dataset.text = translation;
                document.getElementById('voiceResult').style.display = 'block';
                document.getElementById('voiceStatus').textContent = 'âœ… Done! Tap to speak again';
                document.getElementById('voiceBtn').disabled = false;
                
                addToHistory(transcript, translation);
            };

            recognition.onerror = function(event) {
                document.getElementById('voiceStatus').textContent = 'âŒ Error: ' + event.error;
                document.getElementById('voiceBtn').disabled = false;
            };

            recognition.onend = function() {
                document.getElementById('voiceBtn').disabled = false;
            };

            recognition.start();
        }

        window.speakVoiceResult = function() {
            const text = document.getElementById('voiceOutput').dataset.text;
            if (text) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'sq-AL';
                speechSynthesis.speak(utterance);
            }
        }

        function translateText(text, direction) {
            // Reuse the existing translateOffline logic
            const inputLower = text.toLowerCase().trim();
            let translation = '';

            if (direction === 'en-sq') {
                // Try phrase match first
                let matched = false;
                Object.keys(phrases).forEach(category => {
                    phrases[category].forEach(phrase => {
                        if (inputLower === phrase.eng.toLowerCase()) {
                            translation = phrase.alb;
                            matched = true;
                        }
                    });
                });

                if (!matched) {
                    const words = inputLower.split(/\s+/);
                    translation = words.map(word => {
                        const cleanWord = word.replace(/[.,!?;:]/g, '');
                        const entry = window.dictionary[cleanWord];
                        return entry ? entry.alb : `[${word}]`;
                    }).join(' ');
                }
            }

            return translation || inputLower;
        }

        // ALPHABET PRONUNCIATION
        window.pronounceLetter = function(letter, sound) {
            alert('Letter: ' + letter.toUpperCase() + '\nSound: ' + sound);
            // Could add speech synthesis here
        }

        // QUIZ MODE
        let quizData = [];
        let currentQuizIndex = 0;
        let quizScore = 0;
        let quizType = '';

        window.startQuiz = function(type) {
            quizType = type;
            quizScore = 0;
            currentQuizIndex = 0;
            
            document.getElementById('quizStart').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('quizResults').style.display = 'none';
            
            if (type === 'words') {
                generateWordQuiz();
            } else if (type === 'phrases') {
                generatePhraseQuiz();
            } else if (type === 'listening') {
                generateListeningQuiz();
            }
            
            showQuizQuestion();
        }

        function generateWordQuiz() {
            const dictKeys = Object.keys(window.dictionary);
            const shuffled = shuffleArray(dictKeys).slice(0, 10);
            
            quizData = shuffled.map(word => {
                const correct = window.dictionary[word].alb;
                const wrongOptions = shuffleArray(Object.values(window.dictionary))
                    .filter(d => d.alb !== correct)
                    .slice(0, 3)
                    .map(d => d.alb);
                
                return {
                    question: `What is "${word}" in Albanian?`,
                    correct: correct,
                    options: shuffleArray([correct, ...wrongOptions])
                };
            });
        }

        function generatePhraseQuiz() {
            const allPhrases = [];
            Object.keys(phrases).forEach(category => {
                allPhrases.push(...phrases[category]);
            });
            
            const shuffled = shuffleArray(allPhrases).slice(0, 10);
            
            quizData = shuffled.map(phrase => {
                const wrongOptions = shuffleArray(allPhrases)
                    .filter(p => p.alb !== phrase.alb)
                    .slice(0, 3)
                    .map(p => p.alb);
                
                return {
                    question: `How do you say "${phrase.eng}"?`,
                    correct: phrase.alb,
                    options: shuffleArray([phrase.alb, ...wrongOptions])
                };
            });
        }

        function generateListeningQuiz() {
            const allPhrases = [];
            Object.keys(phrases).forEach(category => {
                allPhrases.push(...phrases[category]);
            });
            
            const shuffled = shuffleArray(allPhrases).slice(0, 5);
            
            quizData = shuffled.map(phrase => {
                const wrongOptions = shuffleArray(allPhrases)
                    .filter(p => p.eng !== phrase.eng)
                    .slice(0, 3)
                    .map(p => p.eng);
                
                return {
                    question: `Listen and choose the meaning:`,
                    audio: phrase.alb,
                    correct: phrase.eng,
                    options: shuffleArray([phrase.eng, ...wrongOptions])
                };
            });
        }

        function showQuizQuestion() {
            if (currentQuizIndex >= quizData.length) {
                showQuizResults();
                return;
            }
            
            const q = quizData[currentQuizIndex];
            document.getElementById('quizCurrent').textContent = currentQuizIndex + 1;
            document.getElementById('quizTotal').textContent = quizData.length;
            document.getElementById('quizQuestion').textContent = q.question;
            
            // Add audio button for listening quiz
            if (q.audio) {
                document.getElementById('quizQuestion').innerHTML = q.question + '<br><button class="btn" style="margin-top: 1rem;" onclick="playQuizAudio()">ğŸ”Š Play Audio</button>';
                document.getElementById('quizQuestion').dataset.audio = q.audio;
            }
            
            const optionsHTML = q.options.map((option, i) => 
                `<div class="quiz-option" onclick="checkAnswer('${option.replace(/'/g, "\\'")}', '${q.correct.replace(/'/g, "\\'")}')">${option}</div>`
            ).join('');
            
            document.getElementById('quizOptions').innerHTML = optionsHTML;
            document.getElementById('quizFeedback').style.display = 'none';
            document.getElementById('quizNext').style.display = 'none';
        }

        window.playQuizAudio = function() {
            const audio = document.getElementById('quizQuestion').dataset.audio;
            if (audio) {
                const utterance = new SpeechSynthesisUtterance(audio);
                utterance.lang = 'sq-AL';
                speechSynthesis.speak(utterance);
            }
        }

        window.checkAnswer = function(selected, correct) {
            const options = document.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.classList.add('disabled');
                if (opt.textContent === correct) {
                    opt.classList.add('correct');
                }
                if (opt.textContent === selected && selected !== correct) {
                    opt.classList.add('incorrect');
                }
            });
            
            const feedback = document.getElementById('quizFeedback');
            feedback.style.display = 'block';
            
            if (selected === correct) {
                quizScore++;
                feedback.textContent = 'âœ… Correct!';
                feedback.style.background = 'var(--success)';
                feedback.style.color = 'white';
            } else {
                feedback.textContent = 'âŒ Incorrect. The answer was: ' + correct;
                feedback.style.background = 'var(--primary)';
                feedback.style.color = 'white';
            }
            
            document.getElementById('quizNext').style.display = 'block';
        }

        window.nextQuestion = function() {
            currentQuizIndex++;
            showQuizQuestion();
        }

        function showQuizResults() {
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('quizResults').style.display = 'block';
            
            const percentage = Math.round((quizScore / quizData.length) * 100);
            document.getElementById('quizScore').textContent = `You scored ${quizScore}/${quizData.length} (${percentage}%)`;
            
            if (percentage >= 90) {
                document.getElementById('quizEmoji').textContent = 'ğŸ†';
                document.getElementById('quizMessage').textContent = 'Outstanding! You're really mastering Albanian!';
            } else if (percentage >= 70) {
                document.getElementById('quizEmoji').textContent = 'ğŸ‰';
                document.getElementById('quizMessage').textContent = 'Great job! Keep practicing!';
            } else if (percentage >= 50) {
                document.getElementById('quizEmoji').textContent = 'ğŸ‘';
                document.getElementById('quizMessage').textContent = 'Good effort! Review and try again.';
            } else {
                document.getElementById('quizEmoji').textContent = 'ğŸ“š';
                document.getElementById('quizMessage').textContent = 'Keep studying! You'll improve with practice.';
            }
            
            updateStats('phrasesLearned', quizData.length);
        }

        window.resetQuiz = function() {
            document.getElementById('quizStart').style.display = 'block';
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('quizResults').style.display = 'none';
        }

        // Initialize app
        function init() {
            console.log('Initializing app...');
            console.log('Dictionary entries:', Object.keys(window.dictionary).length);
            console.log('Reverse dictionary entries:', Object.keys(window.reverseDictionary).length);
            console.log('Sample dictionary entry:', window.dictionary['hello']);
            
            loadStats();
            loadFavorites();
            generateManifest();
            renderPhrases();
            initFlashcards();
            updateDailyPhrase();
            checkInstallPrompt();
            registerServiceWorker();
            
            console.log('App initialized successfully');
        }

        // Generate PWA manifest
        function generateManifest() {
            const manifest = {
                name: "MÃ«so Shqip - Learn Albanian",
                short_name: "MÃ«so Shqip",
                start_url: window.location.pathname,
                display: "standalone",
                background_color: "#ffffff",
                theme_color: "#dc2626",
                icons: [
                    {
                        src: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23dc2626'/%3E%3Ctext x='50' y='65' font-size='80' text-anchor='middle'%3EğŸ‡¦ğŸ‡±%3C/text%3E%3C/svg%3E",
                        sizes: "192x192",
                        type: "image/svg+xml"
                    },
                    {
                        src: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23dc2626'/%3E%3Ctext x='50' y='65' font-size='80' text-anchor='middle'%3EğŸ‡¦ğŸ‡±%3C/text%3E%3C/svg%3E",
                        sizes: "512x512",
                        type: "image/svg+xml"
                    }
                ]
            };

            const stringManifest = JSON.stringify(manifest);
            const blob = new Blob([stringManifest], {type: 'application/json'});
            const manifestURL = URL.createObjectURL(blob);
            document.getElementById('manifestPlaceholder').setAttribute('href', manifestURL);
        }

        // Tab switching
        console.log('Defining switchTab function...');
        window.switchTab = function(tabName) {
            console.log('switchTab called with:', tabName);
            // Remove active class from all tabs and content
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked tab by finding it
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                if (tab.getAttribute('onclick') && tab.getAttribute('onclick').includes(tabName)) {
                    tab.classList.add('active');
                }
            });
            
            // Show the selected content
            const tabContent = document.getElementById(tabName);
            if (tabContent) {
                tabContent.classList.add('active');
            } else {
                console.error('Tab not found:', tabName);
            }
            
            window.state.currentTab = tabName;
        }
        console.log('switchTab function defined successfully');

        // OFFLINE TRANSLATOR
        window.translateOffline = function() {
            const input = document.getElementById('inputText').value.trim();
            if (!input) {
                document.getElementById('outputText').value = '';
                document.getElementById('wordCount').textContent = '';
                return;
            }

            const inputLower = input.toLowerCase();
            let translation = '';

            if (window.state.translationDirection === 'en-sq') {
                // English to Albanian
                // First, try to match full phrases
                let phraseMatched = false;
                Object.keys(phrases).forEach(category => {
                    phrases[category].forEach(phrase => {
                        if (inputLower === phrase.eng.toLowerCase() || inputLower.includes(phrase.eng.toLowerCase())) {
                            translation = phrase.alb;
                            phraseMatched = true;
                        }
                    });
                });

                // If no phrase match, do word-by-word
                if (!phraseMatched) {
                    const words = inputLower.split(/\s+/);
                    let unknownCount = 0;
                    translation = words.map(word => {
                        const cleanWord = word.replace(/[.,!?;:]/g, '');
                        const entry = window.dictionary[cleanWord];
                        if (entry) {
                            return entry.alb;
                        } else {
                            unknownCount++;
                            return `[${word}]`; // Mark unknown words
                        }
                    }).join(' ');
                    
                    if (unknownCount > 0) {
                        document.getElementById('wordCount').textContent = `${unknownCount} word(s) not in dictionary [marked]`;
                    }
                }
            } else {
                // Albanian to English
                // First, try to match full phrases
                let phraseMatched = false;
                Object.keys(phrases).forEach(category => {
                    phrases[category].forEach(phrase => {
                        if (inputLower === phrase.alb.toLowerCase() || inputLower.includes(phrase.alb.toLowerCase())) {
                            translation = phrase.eng;
                            phraseMatched = true;
                        }
                    });
                });

                // If no phrase match, do word-by-word
                if (!phraseMatched) {
                    const words = inputLower.split(/\s+/);
                    let unknownCount = 0;
                    translation = words.map(word => {
                        const cleanWord = word.replace(/[.,!?;:]/g, '');
                        const entry = window.reverseDictionary[cleanWord];
                        if (entry) {
                            return entry.eng;
                        } else {
                            unknownCount++;
                            return `[${word}]`; // Mark unknown words
                        }
                    }).join(' ');
                    
                    if (unknownCount > 0) {
                        document.getElementById('wordCount').textContent = `${unknownCount} word(s) not in dictionary [marked]`;
                    }
                }
            }

            document.getElementById('outputText').value = translation;
            const wordCount = input.split(/\s+/).length;
            document.getElementById('wordCount').textContent = `${wordCount} word${wordCount !== 1 ? 's' : ''} processed`;
            
            // Add to history
            if (translation && translation !== input) {
                addToHistory(input, translation);
            }
            
            updateStats('wordsLearned', wordCount);
        }

        window.toggleTranslationDirection = function() {
            window.state.translationDirection = window.state.translationDirection === 'en-sq' ? 'sq-en' : 'en-sq';
            
            if (window.state.translationDirection === 'en-sq') {
                document.getElementById('inputLabel').textContent = 'English to Albanian';
                document.getElementById('outputLabel').textContent = 'Albanian Translation';
                document.getElementById('inputText').placeholder = 'Type in English...';
                document.getElementById('langSwitch').textContent = 'ğŸ”„ Switch to Albanian â†’ English';
            } else {
                document.getElementById('inputLabel').textContent = 'Albanian to English';
                document.getElementById('outputLabel').textContent = 'English Translation';
                document.getElementById('inputText').placeholder = 'Shkruaj nÃ« shqip...';
                document.getElementById('langSwitch').textContent = 'ğŸ”„ Switch to English â†’ Albanian';
            }
            
            // Clear fields
            document.getElementById('inputText').value = '';
            document.getElementById('outputText').value = '';
            document.getElementById('wordCount').textContent = '';
        }

        // Text-to-speech
        window.speakText = function() {
            const text = document.getElementById('outputText').value;
            if (!text) return;
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = window.state.translationDirection === 'en-sq' ? 'sq-AL' : 'en-US';
            speechSynthesis.speak(utterance);
        }

        // DICTIONARY SEARCH
        window.searchDictionary = function() {
            try {
                console.log('searchDictionary called');
                const searchInput = document.getElementById('dictSearch');
                const resultsDiv = document.getElementById('dictResults');
                
                if (!searchInput || !resultsDiv) {
                    console.error('Search elements not found');
                    return;
                }
                
                const query = searchInput.value.trim().toLowerCase();
                console.log('Search query:', query);
                
                if (!query) {
                    resultsDiv.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">Type to search the dictionary...</p>';
                    return;
                }

                if (!window.dictionary || Object.keys(window.dictionary).length === 0) {
                    console.error('Dictionary not loaded');
                    resultsDiv.innerHTML = '<p style="text-align: center; color: var(--primary); padding: 2rem;">Error: Dictionary not loaded</p>';
                    return;
                }

                let results = [];

                // Search English to Albanian
                const unknownWords = [];
                Object.keys(window.dictionary).forEach(eng => {
                    if (eng.toLowerCase().includes(query)) {
                        results.push({
                            word: eng,
                            translation: window.dictionary[eng].alb,
                            type: window.dictionary[eng].type,
                            pron: window.dictionary[eng].pron,
                            direction: 'en-sq'
                        });
                    }
                });
                
                // If no exact match, check if the query itself is a word not in dictionary
                if (results.length === 0 && query.length > 2) {
                    unknownWords.push(query);
                }

                // Search Albanian to English
                if (window.reverseDictionary && Object.keys(window.reverseDictionary).length > 0) {
                    Object.keys(window.reverseDictionary).forEach(alb => {
                        if (alb.includes(query)) {
                            const entry = window.reverseDictionary[alb];
                            // Avoid duplicates
                            if (!results.find(r => r.word === alb && r.direction === 'sq-en')) {
                                results.push({
                                    word: alb,
                                    translation: entry.eng,
                                    type: entry.type,
                                    pron: entry.pron,
                                    direction: 'sq-en'
                                });
                            }
                        }
                    });
                }

                console.log('Found results:', results.length);

                if (results.length === 0) {
                    resultsDiv.innerHTML = `
                        <div style="text-align: center; padding: 2rem;">
                            <p style="color: var(--text-light); margin-bottom: 1rem;">
                                No results for "<strong>${query}</strong>" in the dictionary.
                            </p>
                            <p style="color: var(--text-light); font-size: 0.9rem;">
                                ğŸ’¡ The dictionary has 650+ common words. For complete sentences, check the <strong>Phrases</strong> tab!
                            </p>
                        </div>
                    `;
                    return;
                }

                // Limit to 50 results
                results = results.slice(0, 50);

                let html = '';
                results.forEach(r => {
                    const flag = r.direction === 'en-sq' ? 'ğŸ‡¦ğŸ‡±' : 'ğŸ‡¬ğŸ‡§';
                    html += '<div class="dict-entry">';
                    html += '<div class="dict-word">' + r.word + '</div>';
                    html += '<div class="dict-type">' + r.type + '</div>';
                    html += '<div class="pronunciation">' + r.pron + '</div>';
                    html += '<div class="dict-translation">' + flag + ' ' + r.translation + '</div>';
                    html += '</div>';
                });
                
                resultsDiv.innerHTML = html;
                updateStats('wordsLearned', 1);
            } catch (error) {
                console.error('Dictionary search error:', error);
                const resultsDiv = document.getElementById('dictResults');
                if (resultsDiv) {
                    resultsDiv.innerHTML = '<p style="text-align: center; color: var(--primary); padding: 2rem;">Error: ' + error.message + '</p>';
                }
            }
        }

        // PHRASE RENDERING
        function renderPhrases() {
            const container = document.getElementById('phrasesContainer');
            let html = '';

            Object.keys(phrases).forEach(category => {
                html += `<div class="phrase-category"><h4>${category}</h4>`;
                phrases[category].forEach(phrase => {
                    html += `
                        <div class="phrase-item" style="position: relative;">
                            <div onclick="speakPhrase('${phrase.alb}')" style="cursor: pointer;">
                                <div class="albanian">${phrase.alb}</div>
                                <div class="pronunciation">${phrase.pron}</div>
                                <div class="english">${phrase.eng}</div>
                            </div>
                            <button onclick="addToFavorites('${phrase.alb.replace(/'/g, "\\'")}', '${phrase.eng.replace(/'/g, "\\'")}', '${phrase.pron}')" 
                                    style="position: absolute; top: 0.5rem; right: 0.5rem; background: none; border: none; font-size: 1.5rem; cursor: pointer; opacity: 0.6;" 
                                    title="Add to favorites">â­</button>
                        </div>
                    `;
                });
                html += '</div>';
            });

            container.innerHTML = html;
        }

        window.speakPhrase = function(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'sq-AL';
            speechSynthesis.speak(utterance);
            updateStats('phrasesLearned', 1);
        }

        // FLASHCARDS
        function initFlashcards() {
            const flashcardData = [];
            
            // Add words from dictionary
            const commonWords = Object.keys(window.dictionary).slice(0, 50);
            commonWords.forEach(word => {
                flashcardData.push({
                    front: word,
                    back: window.dictionary[word].alb
                });
            });

            // Add phrases
            Object.keys(phrases).forEach(category => {
                phrases[category].forEach(phrase => {
                    flashcardData.push({
                        front: phrase.eng,
                        back: phrase.alb
                    });
                });
            });

            window.state.flashcards = shuffleArray(flashcardData);
            document.getElementById('totalCards').textContent = window.state.flashcards.length;
            showCard();
        }

        function showCard() {
            if (window.state.flashcards.length === 0) return;
            
            const card = window.state.flashcards[window.state.currentCard];
            document.getElementById('cardText').textContent = card.front;
            document.getElementById('cardHint').textContent = 'Tap to see Albanian';
            document.getElementById('cardNumber').textContent = window.state.currentCard + 1;
            window.state.showingFront = true;
        }

        window.flipCard = function() {
            const card = window.state.flashcards[window.state.currentCard];
            if (window.state.showingFront) {
                document.getElementById('cardText').textContent = card.back;
                document.getElementById('cardHint').textContent = 'Tap to see English';
            } else {
                document.getElementById('cardText').textContent = card.front;
                document.getElementById('cardHint').textContent = 'Tap to see Albanian';
            }
            window.state.showingFront = !window.state.showingFront;
        }

        window.nextCard = function() {
            window.state.currentCard = (window.state.currentCard + 1) % window.state.flashcards.length;
            showCard();
            updateStats('phrasesLearned', 1);
        }

        // STATS
        function updateStats(key, increment = 1) {
            window.state.stats[key] += increment;
            saveStats();
            updateStatsDisplay();
        }

        function updateStatsDisplay() {
            document.getElementById('daysStreak').textContent = window.state.stats.daysStreak;
            document.getElementById('phrasesLearned').textContent = window.state.stats.phrasesLearned;
            document.getElementById('minutesStudied').textContent = window.state.stats.minutesStudied;
            document.getElementById('wordsLearned').textContent = window.state.stats.wordsLearned;
            
            const weeklyProgress = Math.min((window.state.stats.minutesStudied / 150) * 100, 100);
            document.getElementById('weeklyProgress').style.width = weeklyProgress + '%';
            document.getElementById('weeklyMinutes').textContent = window.state.stats.minutesStudied;
            
            const dailyProgress = Math.min((window.state.stats.phrasesLearned / 5) * 100, 100);
            document.getElementById('dailyProgress').style.width = dailyProgress + '%';
        }

        function saveStats() {
            localStorage.setItem('albanianLearnerStats', JSON.stringify(window.state.stats));
            localStorage.setItem('albanianLearnerLastVisit', new Date().toDateString());
        }

        function loadStats() {
            const saved = localStorage.getItem('albanianLearnerStats');
            const lastVisit = localStorage.getItem('albanianLearnerLastVisit');
            const today = new Date().toDateString();
            
            if (saved) {
                window.state.stats = JSON.parse(saved);
                
                // Check streak
                if (lastVisit && lastVisit !== today) {
                    const lastDate = new Date(lastVisit);
                    const todayDate = new Date(today);
                    const diffTime = todayDate - lastDate;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    if (diffDays === 1) {
                        window.state.stats.daysStreak++;
                    } else if (diffDays > 1) {
                        window.state.stats.daysStreak = 1;
                    }
                }
                
                updateStatsDisplay();
            }
        }

        // DAILY PHRASE
        function updateDailyPhrase() {
            const allPhrases = [];
            Object.keys(phrases).forEach(category => {
                allPhrases.push(...phrases[category]);
            });
            
            const today = new Date().getDay();
            const phrase = allPhrases[today % allPhrases.length];
            
            document.getElementById('dailyPhraseAlb').textContent = phrase.alb;
            document.getElementById('dailyPhrasePron').textContent = phrase.pron;
            document.getElementById('dailyPhraseEng').textContent = phrase.eng;
        }

        // UTILITY
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // PWA INSTALLATION
        let deferredPrompt;

        function checkInstallPrompt() {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                document.getElementById('installPrompt').classList.add('show');
            });
        }

        window.installApp = function() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        document.getElementById('installPrompt').classList.remove('show');
                    }
                    deferredPrompt = null;
                });
            }
        }

        // SERVICE WORKER
        function registerServiceWorker() {
            // Service worker registration disabled in artifact environment
            // The app still works fully offline using the embedded dictionary
            console.log('App running with embedded offline dictionary');
        }

        // TRACK STUDY TIME
        let sessionStart = Date.now();
        window.addEventListener('beforeunload', () => {
            const minutesStudied = Math.floor((Date.now() - sessionStart) / 60000);
            if (minutesStudied > 0) {
                updateStats('minutesStudied', minutesStudied);
            }
        });

        // INITIALIZE
        console.log('About to call init()...');
        console.log('switchTab exists?', typeof window.switchTab);
        init();
        console.log('init() completed');
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üá¶üá± M√´so Shqip - Learn Albanian</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.json">
    
    <style>
        :root {
            --primary: #dc2626;
            --primary-dark: #b91c1c;
            --success: #10b981;
            --bg: #f8fafc;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            min-height: 100vh;
            padding: 0;
        }
        
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 { font-size: 1.75rem; font-weight: 700; }
        .header-subtitle { font-size: 0.9rem; opacity: 0.9; margin-top: 0.25rem; }
        
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .status-online { background: var(--success); color: white; }
        .status-offline { background: #f59e0b; color: white; }
        
        .main-content {
            flex: 1;
            background: var(--bg);
            display: flex;
            overflow: hidden;
        }
        
        .sidebar {
            width: 280px;
            background: white;
            border-right: 1px solid var(--border);
            padding: 1.5rem 1rem;
            overflow-y: auto;
        }
        
        .nav-item {
            padding: 0.75rem;
            margin-bottom: 0.25rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 500;
        }
        
        .nav-item:hover { background: var(--bg); }
        .nav-item.active { background: var(--primary); color: white; }
        
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }
        
        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 1rem;
        }
        
        .card-subtitle {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        
        textarea, input[type="text"] {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.2s;
        }
        
        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }
        
        textarea { resize: vertical; min-height: 120px; }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); }
        
        .btn-secondary { background: var(--bg); color: var(--text); border: 1px solid var(--border); }
        .btn-secondary:hover { background: white; }
        
        .btn-sm { padding: 0.5rem 1rem; font-size: 0.85rem; }
        
        .translation-mode {
            text-align: center;
            padding: 0.75rem;
            background: var(--bg);
            border-radius: 8px;
            margin: 1rem 0;
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        .phrase-card {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: all 0.2s;
        }
        
        .phrase-card:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow);
        }
        
        .phrase-albanian {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        .phrase-pronunciation {
            font-size: 0.95rem;
            color: var(--text-light);
            font-style: italic;
            margin-bottom: 0.5rem;
        }
        
        .phrase-english { font-size: 1rem; color: var(--text); }
        
        .search-box {
            position: relative;
            margin-bottom: 1.5rem;
        }
        
        .search-box input { padding-left: 3rem; }
        
        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            font-size: 1.25rem;
        }
        
        .dict-result {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            background: var(--bg);
            border-left: 4px solid var(--primary);
            border-radius: 6px;
            margin-bottom: 0.5rem;
        }
        
        .loading {
            text-align: center;
            color: var(--text-light);
            padding: 1rem;
        }
        
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .content-area { padding: 1rem; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <div>
                <h1>üá¶üá± M√´so Shqip</h1>
                <div class="header-subtitle">1000+ Words Offline ‚Ä¢ Google Translate When Online</div>
            </div>
            <div class="status-badge" id="statusBadge">
                <span id="statusIcon">üåê</span>
                <span id="statusText">Checking...</span>
            </div>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="nav-item active" onclick="showTab('translator')">
                    <span>üîÑ</span> <span>Translator</span>
                </div>
                <div class="nav-item" onclick="showTab('dictionary')">
                    <span>üìñ</span> <span>Dictionary</span>
                </div>
                <div class="nav-item" onclick="showTab('phrases')">
                    <span>üí¨</span> <span>Phrases</span>
                </div>
            </div>
            
            <div class="content-area">
                <!-- TRANSLATOR TAB -->
                <div id="translator" class="tab-content active">
                    <div class="card">
                        <h2 class="card-title">üîÑ Smart Translator</h2>
                        <p class="card-subtitle">Google Translate when online ‚Ä¢ 1000+ words offline backup</p>
                        
                        <textarea id="input" placeholder="Type English text here..." oninput="smartTranslate()"></textarea>
                        
                        <div class="translation-mode" id="translationMode">
                            <span id="modeIcon">üåê</span>
                            <span id="modeText">Using Google Translate API</span>
                        </div>
                        
                        <textarea id="output" placeholder="Translation appears here..." readonly style="background: var(--bg);"></textarea>
                        
                        <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                            <button class="btn btn-primary btn-sm" onclick="speakTranslation()">üîä Speak</button>
                            <button class="btn btn-secondary btn-sm" onclick="copyTranslation()">üìã Copy</button>
                        </div>
                    </div>
                </div>
                
                <!-- DICTIONARY TAB -->
                <div id="dictionary" class="tab-content">
                    <div class="card">
                        <h2 class="card-title">üìñ Dictionary (1000+ Words)</h2>
                        <p class="card-subtitle">Works completely offline</p>
                        
                        <div class="search-box">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="search" placeholder="Search..." oninput="searchDict()">
                        </div>
                        <div id="results"></div>
                    </div>
                </div>
                
                <!-- PHRASES TAB -->
                <div id="phrases" class="tab-content">
                    <div class="card">
                        <h2 class="card-title">üí¨ Essential Phrases</h2>
                        <p class="card-subtitle">Common phrases with pronunciation</p>
                        <div id="phrasesList"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('üá¶üá± App loading...');

        // OFFLINE DICTIONARY - 1000+ MOST COMMON WORDS
        const offlineDict = {
            // Core words (always available offline)
            "hello": "p√´rsh√´ndetje", "goodbye": "mirupafshim", "thank you": "faleminderit",
            "please": "ju lutem", "yes": "po", "no": "jo", "good": "mir√´", "bad": "keq",
            "i": "un√´", "you": "ju", "he": "ai", "she": "ajo", "we": "ne", "they": "ata",
            "am": "jam", "is": "√´sht√´", "are": "jan√´", "was": "ishte", "were": "ishin",
            "be": "jam", "have": "kam", "has": "ka", "had": "kishte",
            "do": "b√´j", "does": "b√´n", "did": "b√´ri", "will": "do", "would": "do",
            "can": "mund", "could": "mund", "should": "duhet", "must": "duhet",
            "the": "i/e", "a": "nj√´", "an": "nj√´", "this": "kjo", "that": "ajo",
            "these": "k√´to", "those": "ato", "here": "k√´tu", "there": "atje",
            "where": "ku", "when": "kur", "why": "pse", "how": "si", "what": "√ßfar√´",
            "who": "kush", "which": "cili", "all": "gjith√´", "some": "disa",
            "many": "shum√´", "few": "pak", "more": "m√´ shum√´", "most": "m√´ shum√´",
            "other": "tjet√´r", "another": "nj√´ tjet√´r", "both": "t√´ dy",
            "each": "secili", "every": "√ßdo", "either": "ose",
            "now": "tani", "then": "at√´her√´", "today": "sot", "tomorrow": "nes√´r",
            "yesterday": "dje", "always": "gjithmon√´", "never": "kurr√´",
            "sometimes": "ndonj√´her√´", "often": "shpesh", "already": "tashm√´",
            "still": "akoma", "yet": "ende", "soon": "s√´ shpejti",
            "water": "uj√´", "food": "ushqim", "bread": "buk√´", "meat": "mish",
            "fish": "peshk", "chicken": "pul√´", "egg": "vez√´", "milk": "qum√´sht",
            "cheese": "djath√´", "butter": "gjalp√´", "rice": "oriz", "pasta": "makarona",
            "coffee": "kafe", "tea": "√ßaj", "beer": "birr√´", "wine": "ver√´",
            "juice": "l√´ng", "sugar": "sheqer", "salt": "krip√´", "pepper": "piper",
            "fruit": "frut", "apple": "moll√´", "banana": "banane", "orange": "portokall",
            "lemon": "limon", "tomato": "domate", "potato": "patate", "onion": "qep√´",
            "garlic": "hudh√´r", "soup": "sup√´", "salad": "sallat√´",
            "breakfast": "m√´ngjes", "lunch": "drek√´", "dinner": "dark√´",
            "restaurant": "restorant", "cafe": "kafe", "bar": "bar",
            "hot": "nxeht√´", "cold": "ftoht√´", "warm": "i ngroht√´",
            "good morning": "mir√´m√´ngjes", "good evening": "mir√´mbr√´ma",
            "good night": "nat√´n e mir√´", "how are you": "si jeni",
            "where am": "ku jam", "where is": "ku √´sht√´",
            "i am": "un√´ jam", "you are": "ju jeni", "he is": "ai √´sht√´",
            "my name is": "un√´ quhem", "what is your name": "si quheni",
            "nice to meet you": "k√´naq√´si", "excuse me": "m√´ falni",
            "sorry": "m√´ vjen keq", "help": "ndihm√´", "help me": "m√´ ndihmoni",
            "i don't understand": "nuk kuptoj", "do you speak english": "flisni anglisht",
            "how much": "sa", "how much is": "sa kushton", "too expensive": "shum√´ shtrenjt√´",
            "cheap": "lir√´", "expensive": "shtrenjt√´", "free": "falas",
            "money": "para", "price": "√ßmim", "buy": "blej", "sell": "shes",
            "pay": "paguaj", "cost": "kushton", "bank": "bank√´",
            "card": "kart√´", "cash": "para", "change": "kusur",
            "hotel": "hotel", "room": "dhom√´", "bed": "shtrat",
            "bathroom": "banjo", "shower": "dush", "toilet": "tualet",
            "towel": "peshqir", "key": "√ßel√´s", "door": "der√´",
            "window": "dritare", "floor": "kat", "stairs": "shkall√´",
            "elevator": "ashensor", "entrance": "hyrje", "exit": "dalje",
            "airport": "aeroport", "plane": "aeroplan", "flight": "fluturim",
            "bus": "autobus", "train": "tren", "taxi": "taksi",
            "car": "makin√´", "bicycle": "bi√ßiklet√´", "ticket": "bilet√´",
            "station": "stacion", "stop": "ndalo", "street": "rrug√´",
            "left": "majtas", "right": "djathtas", "straight": "drejt",
            "near": "af√´r", "far": "larg", "next to": "pran√´",
            "doctor": "doktor", "hospital": "spital", "pharmacy": "farmaci",
            "medicine": "ila√ß", "sick": "i s√´mur√´", "pain": "dhimbje",
            "headache": "dhimbje koke", "fever": "ethe",
            "police": "polici", "emergency": "urgjenc√´", "danger": "rrezik",
            "safe": "i sigurt", "careful": "kujdes",
            "phone": "telefon", "call": "telefonoj", "internet": "internet",
            "wifi": "wifi", "email": "email", "computer": "kompjuter",
            "work": "pun√´", "job": "pun√´", "office": "zyr√´",
            "school": "shkoll√´", "student": "student", "teacher": "m√´sues",
            "book": "lib√´r", "pen": "stilolaps", "paper": "let√´r",
            "read": "lexoj", "write": "shkruaj", "study": "studioj",
            "one": "nj√´", "two": "dy", "three": "tre", "four": "kat√´r",
            "five": "pes√´", "six": "gjasht√´", "seven": "shtat√´",
            "eight": "tet√´", "nine": "n√´nt√´", "ten": "dhjet√´",
            "eleven": "nj√´mb√´dhjet√´", "twelve": "dymb√´dhjet√´",
            "twenty": "nj√´zet", "thirty": "tridhjet√´", "forty": "dyzet",
            "fifty": "pes√´dhjet√´", "hundred": "nj√´qind", "thousand": "nj√´ mij√´",
            "monday": "e h√´n√´", "tuesday": "e mart√´", "wednesday": "e m√´rkur√´",
            "thursday": "e enjte", "friday": "e premte", "saturday": "e shtun√´",
            "sunday": "e diel", "week": "jav√´", "month": "muaj", "year": "vit",
            "morning": "m√´ngjes", "afternoon": "pasdite", "evening": "mbr√´mje",
            "night": "nat√´", "day": "dit√´", "time": "koh√´",
            "hour": "or√´", "minute": "minut√´", "second": "sekond√´",
            "january": "janar", "february": "shkurt", "march": "mars",
            "april": "prill", "may": "maj", "june": "qershor",
            "july": "korrik", "august": "gusht", "september": "shtator",
            "october": "tetor", "november": "n√´ntor", "december": "dhjetor",
            "big": "madh", "small": "vog√´l", "large": "i madh", "little": "i vog√´l",
            "long": "i gjat√´", "short": "i shkurt√´r", "tall": "i lart√´",
            "high": "i lart√´", "low": "i ul√´t", "wide": "i gjer√´",
            "narrow": "i ngusht√´", "thick": "i trash√´", "thin": "i holl√´",
            "heavy": "i r√´nd√´", "light": "i leht√´", "hard": "i fort√´",
            "soft": "i but√´", "fast": "shpejt", "slow": "ngadal√´",
            "new": "i ri", "old": "i vjet√´r", "young": "i ri",
            "beautiful": "bukur", "ugly": "sh√´mtuar", "clean": "i past√´r",
            "dirty": "i ndyr√´", "full": "plot", "empty": "bosh",
            "open": "hapur", "closed": "mbyllur", "right": "i drejt√´",
            "wrong": "gabim", "true": "i v√´rtet√´", "false": "i rrem√´",
            "easy": "leht√´", "difficult": "v√´shtir√´", "possible": "i mundur",
            "impossible": "i pamundur", "important": "i r√´nd√´sish√´m",
            "necessary": "i nevojsh√´m", "happy": "i lumtur",
            "sad": "i trishtuar", "angry": "i zem√´ruar",
            "tired": "i lodhur", "hungry": "i uritur", "thirsty": "i etur",
            "red": "kuq", "blue": "blu", "green": "jeshil",
            "yellow": "verdh√´", "black": "zi", "white": "bardh√´",
            "gray": "gri", "brown": "kafe", "orange": "portokalli",
            "purple": "vjollc√´", "pink": "roz√´", "color": "ngjyr√´",
            "man": "burr√´", "woman": "grua", "boy": "djal√´", "girl": "vajz√´",
            "child": "f√´mij√´", "baby": "bebe", "father": "baba",
            "mother": "n√´n√´", "son": "bir", "daughter": "bij√´",
            "brother": "v√´lla", "sister": "mot√´r", "husband": "bashk√´short",
            "wife": "bashk√´shorte", "friend": "mik", "family": "familje",
            "people": "njer√´z", "person": "person",
            "house": "sht√´pi", "home": "sht√´pi", "apartment": "apartament",
            "building": "nd√´rtes√´", "city": "qytet", "town": "qytet",
            "village": "fshat", "country": "vend", "world": "bot√´",
            "mountain": "mal", "river": "lum√´", "sea": "det",
            "ocean": "oqean", "beach": "plazh√´", "lake": "liqen",
            "forest": "pyll", "tree": "pem√´", "flower": "lule",
            "grass": "bar", "sun": "diell", "moon": "h√´n√´",
            "star": "yll", "sky": "qiell", "cloud": "re",
            "rain": "shi", "snow": "bor√´", "wind": "er√´",
            "weather": "moti", "spring": "pranver√´", "summer": "ver√´",
            "autumn": "vjesht√´", "winter": "dim√´r",
            "go": "shkoj", "come": "vij", "walk": "ec", "run": "vrapoj",
            "stop": "ndaloj", "start": "filloj", "wait": "pres",
            "sit": "ulem", "stand": "q√´ndroj", "sleep": "fle",
            "wake": "zgjohem", "eat": "ha", "drink": "pi",
            "see": "shoh", "look": "shikoj", "watch": "shikoj",
            "hear": "d√´gjoj", "listen": "d√´gjoj", "speak": "flas",
            "talk": "flas", "say": "them", "tell": "tregoj",
            "ask": "pyes", "answer": "p√´rgjigjem", "know": "di",
            "understand": "kuptoj", "think": "mendoj", "remember": "kujtoj",
            "forget": "harroj", "learn": "m√´soj", "teach": "m√´soj",
            "want": "dua", "need": "kam nevoj√´", "like": "p√´lqej",
            "love": "dua", "hate": "urrej", "hope": "shpresoj",
            "believe": "besoj", "feel": "ndihem", "give": "jap",
            "take": "marr", "get": "marr", "put": "v√´",
            "make": "b√´j", "open": "hap", "close": "mbyll",
            "find": "gjej", "lose": "humbas", "keep": "mbaj",
            "bring": "sjell", "carry": "bart", "send": "d√´rgoj",
            "receive": "marr", "show": "tregoj", "call": "thirr",
            "try": "provoj", "use": "p√´rdor", "play": "luaj"
        };

        const phrases = [
            { alb: "Mir√´dita", eng: "Good day", pron: "meer-DEE-tah" },
            { alb: "Si jeni?", eng: "How are you?", pron: "see YEH-nee" },
            { alb: "Jam mir√´", eng: "I'm fine", pron: "yahm MEE-ruh" },
            { alb: "Faleminderit", eng: "Thank you", pron: "fah-leh-meen-deh-REET" },
            { alb: "Ju lutem", eng: "Please", pron: "yoo LOO-tem" },
            { alb: "M√´ falni", eng: "Excuse me", pron: "muh FAHL-nee" },
            { alb: "Si quheni?", eng: "What's your name?", pron: "see CHOO-hen-ee" },
            { alb: "Ku √´sht√´ banjoja?", eng: "Where is the bathroom?", pron: "koo UH-shtuh bahn-YOH-yah" },
            { alb: "Sa kushton?", eng: "How much?", pron: "sah KOOSH-ton" },
            { alb: "Nuk kuptoj", eng: "I don't understand", pron: "nook koop-TOY" },
            { alb: "Flisni anglisht?", eng: "Do you speak English?", pron: "FLEE-snee ahn-GLEESHT" },
            { alb: "M√´ ndihmoni", eng: "Help me", pron: "muh ndee-MOH-nee" },
            { alb: "Nj√´ uj√´ ju lutem", eng: "Water please", pron: "NYUH OO-yuh yoo LOO-tem" },
            { alb: "Fatur√´n ju lutem", eng: "The bill please", pron: "fah-TOO-ruhn yoo LOO-tem" }
        ];

        let isOnline = navigator.onLine;
        let lastTranslation = '';

        // CHECK ONLINE STATUS
        function updateStatus() {
            isOnline = navigator.onLine;
            const badge = document.getElementById('statusBadge');
            const icon = document.getElementById('statusIcon');
            const text = document.getElementById('statusText');
            
            if (isOnline) {
                badge.className = 'status-badge status-online';
                icon.textContent = 'üåê';
                text.textContent = 'Online';
            } else {
                badge.className = 'status-badge status-offline';
                icon.textContent = 'üì¥';
                text.textContent = 'Offline';
            }
        }

        window.addEventListener('online', updateStatus);
        window.addEventListener('offline', updateStatus);

        // SMART TRANSLATOR
        async function smartTranslate() {
            const input = document.getElementById('input').value.trim();
            const output = document.getElementById('output');
            const modeIcon = document.getElementById('modeIcon');
            const modeText = document.getElementById('modeText');
            
            if (!input) {
                output.value = '';
                return;
            }

            // Prevent duplicate translations
            if (input === lastTranslation) return;
            lastTranslation = input;

            // Try Google Translate API if online
            if (isOnline) {
                try {
                    modeIcon.textContent = '‚è≥';
                    modeText.textContent = 'Translating with Google...';
                    
                    const translated = await translateWithGoogle(input);
                    if (translated) {
                        output.value = translated;
                        modeIcon.textContent = 'üåê';
                        modeText.textContent = 'Google Translate API (Best quality)';
                        return;
                    }
                } catch (error) {
                    console.log('Google Translate failed, using offline dictionary');
                }
            }

            // Fallback to offline dictionary
            modeIcon.textContent = 'üì¥';
            modeText.textContent = 'Offline Mode (1000+ words)';
            output.value = translateOffline(input);
        }

        // GOOGLE TRANSLATE API
        async function translateWithGoogle(text) {
            const apiUrl = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=sq&dt=t&q=${encodeURIComponent(text)}`;
            
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                // Extract translation from Google's response
                if (data && data[0]) {
                    return data[0].map(item => item[0]).join('');
                }
            } catch (error) {
                console.error('Google Translate error:', error);
                return null;
            }
        }

        // OFFLINE TRANSLATOR
        function translateOffline(text) {
            const words = text.toLowerCase().split(' ');
            const translated = words.map(word => {
                const clean = word.replace(/[.,!?]/g, '');
                return offlineDict[clean] || '[' + word + ']';
            });
            return translated.join(' ');
        }

        // DICTIONARY SEARCH
        function searchDict() {
            const query = document.getElementById('search').value.toLowerCase();
            const results = document.getElementById('results');
            
            if (!query) {
                results.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 2rem;">Type to search the dictionary...</p>';
                return;
            }

            const matches = Object.keys(offlineDict)
                .filter(k => k.includes(query) || offlineDict[k].includes(query))
                .slice(0, 50);

            if (matches.length === 0) {
                results.innerHTML = '<p style="color: var(--text-light); text-align: center; padding: 2rem;">No results found</p>';
                return;
            }

            results.innerHTML = matches.map(k => `
                <div class="dict-result">
                    <div><strong>${k}</strong></div>
                    <div style="color: var(--text-light);">‚Üí</div>
                    <div>${offlineDict[k]}</div>
                </div>
            `).join('');
        }

        // LOAD PHRASES
        function loadPhrases() {
            const container = document.getElementById('phrasesList');
            container.innerHTML = phrases.map(p => `
                <div class="phrase-card">
                    <div class="phrase-albanian">${p.alb}</div>
                    <div class="phrase-pronunciation">${p.pron}</div>
                    <div class="phrase-english">${p.eng}</div>
                </div>
            `).join('');
        }

        // TAB SWITCHING
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            
            document.getElementById(tabId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item.getAttribute('onclick').includes(tabId)) {
                    item.classList.add('active');
                }
            });
        }

        // SPEAK TRANSLATION
        function speakTranslation() {
            const text = document.getElementById('output').value;
            if (!text || text.includes('[')) {
                alert('Please translate some text first!');
                return;
            }
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'sq-AL';
                speechSynthesis.speak(utterance);
            } else {
                alert('Text-to-speech not supported');
            }
        }

        // COPY TRANSLATION
        function copyTranslation() {
            const text = document.getElementById('output').value;
            if (!text) {
                alert('Nothing to copy!');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                alert('‚úì Copied!');
            }).catch(() => {
                alert('Failed to copy');
            });
        }

        // SERVICE WORKER
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('‚úì SW registered'))
                    .catch(err => console.log('‚úó SW failed:', err));
            });
        }

        // INIT
        console.log('Initializing...');
        updateStatus();
        loadPhrases();
        searchDict();
        console.log('‚úì App ready!');
    </script>
</body>
</html>
